"use strict";(self.webpackChunkmymicroservice_7=self.webpackChunkmymicroservice_7||[]).push([[98344],{98344:(Ye,H,r)=>{r.r(H),r.d(H,{ApplicationFormModalComponent:()=>u,ApplicationsComponent:()=>T,ApplicationsService:()=>S,DEFAULT_APPLICATIONS_CREATE_FORM_PROPS:()=>$,DEFAULT_APPLICATIONS_ENTITY_ACTIONS:()=>oe,DEFAULT_APPLICATIONS_ENTITY_PROPS:()=>ne,DEFAULT_APPLICATIONS_FORM_PROPS:()=>le,DEFAULT_APPLICATIONS_TOOLBAR_ACTIONS:()=>se,DEFAULT_OPENIDDICT_PRO_CREATE_FORM_PROPS:()=>X,DEFAULT_OPENIDDICT_PRO_EDIT_FORM_PROPS:()=>Q,DEFAULT_OPENIDDICT_PRO_ENTITY_ACTIONS:()=>B,DEFAULT_OPENIDDICT_PRO_ENTITY_PROPS:()=>Y,DEFAULT_OPENIDDICT_PRO_TOOLBAR_ACTIONS:()=>W,DEFAULT_SCOPES_ENTITY_PROPS:()=>pe,DEFAULT_SCOPES_FORM_PROPS:()=>ce,DEFAULT_SCOPES_TOOLBAR_ACTIONS:()=>re,DEFAULT_SCOPE_CREATE_FORM_PROPS:()=>z,DEFAULT_SCOPE_ENTITY_ACTIONS:()=>de,DefaultApplicationsConsentType:()=>ie,OPENIDDICT_PRO_CREATE_FORM_PROP_CONTRIBUTORS:()=>D,OPENIDDICT_PRO_EDIT_FORM_PROP_CONTRIBUTORS:()=>k,OPENIDDICT_PRO_ENTITY_ACTION_CONTRIBUTORS:()=>E,OPENIDDICT_PRO_ENTITY_PROP_CONTRIBUTORS:()=>L,OPENIDDICT_PRO_TOOLBAR_ACTION_CONTRIBUTORS:()=>M,OpenIddictProExtensionsGuard:()=>We,OpeniddictproModule:()=>Be,ScopeFormModalComponent:()=>G,ScopesComponent:()=>C,ScopesService:()=>N,TokenLifetimeModalComponent:()=>x,UrisValidator:()=>R,allowFlow:()=>F,defaultApplicationTypes:()=>_,defaultApplicationTypesList:()=>te,defaultApplicationsTypeList:()=>ee,defaultUriPattern:()=>ae,hashSetParser:()=>v});var e=r(93953),p=r(30791),K=r(58780),d=r(39862),a=r(15923);let j=(()=>{class t{constructor(i){this.restService=i,this.apiName="OpenIddictPro",this.create=(o,n)=>this.restService.request({method:"POST",url:"/api/openiddict/applications",body:o},{apiName:this.apiName,...n}),this.delete=(o,n)=>this.restService.request({method:"DELETE",url:"/api/openiddict/applications",params:{id:o}},{apiName:this.apiName,...n}),this.get=(o,n)=>this.restService.request({method:"GET",url:`/api/openiddict/applications/${o}`},{apiName:this.apiName,...n}),this.getList=(o,n)=>this.restService.request({method:"GET",url:"/api/openiddict/applications",params:{filter:o.filter,sorting:o.sorting,skipCount:o.skipCount,maxResultCount:o.maxResultCount}},{apiName:this.apiName,...n}),this.getTokenLifetime=(o,n)=>this.restService.request({method:"GET",url:`/api/openiddict/applications/${o}/token-lifetime`},{apiName:this.apiName,...n}),this.setTokenLifetime=(o,n,l)=>this.restService.request({method:"PUT",url:`/api/openiddict/applications/${o}/token-lifetime`,body:n},{apiName:this.apiName,...l}),this.update=(o,n,l)=>this.restService.request({method:"PUT",url:`/api/openiddict/applications/${o}`,body:n},{apiName:this.apiName,...l})}static{this.\u0275fac=function(o){return new(o||t)(e.KVO(p.G9T))}}static{this.\u0275prov=e.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),V=(()=>{class t{constructor(i){this.restService=i,this.apiName="OpenIddictPro",this.create=(o,n)=>this.restService.request({method:"POST",url:"/api/openiddict/scopes",body:o},{apiName:this.apiName,...n}),this.delete=(o,n)=>this.restService.request({method:"DELETE",url:"/api/openiddict/scopes",params:{id:o}},{apiName:this.apiName,...n}),this.get=(o,n)=>this.restService.request({method:"GET",url:`/api/openiddict/scopes/${o}`},{apiName:this.apiName,...n}),this.getAllScopes=o=>this.restService.request({method:"GET",url:"/api/openiddict/scopes/all"},{apiName:this.apiName,...o}),this.getList=(o,n)=>this.restService.request({method:"GET",url:"/api/openiddict/scopes",params:{filter:o.filter,sorting:o.sorting,skipCount:o.skipCount,maxResultCount:o.maxResultCount}},{apiName:this.apiName,...n}),this.update=(o,n,l)=>this.restService.request({method:"PUT",url:`/api/openiddict/scopes/${o}`,body:n},{apiName:this.apiName,...l})}static{this.\u0275fac=function(o){return new(o||t)(e.KVO(p.G9T))}}static{this.\u0275prov=e.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var be=r(70980),w=r(7673),fe=r(5964),he=r(25558),P=r(96354),J=r(88141),O=r(30946),U=r(21998),q=r(57752),Z=r(60177),m=r(89417),y=r(24721),Te=r(73703),Ie=r(15306);function Oe(t,s){1&t&&(e.j41(0,"h3"),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s()),2&t&&(e.R7$(),e.JRh(e.bMT(2,1,"AbpOpenIddict::TokenLifetime")))}function ve(t,s){if(1&t){const i=e.RV6();e.j41(0,"medium")(1,"p",4),e.EFF(2),e.nI1(3,"abpLocalization"),e.k0s()(),e.j41(4,"form",5),e.bIt("ngSubmit",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.save())}),e.j41(5,"div",6)(6,"label",7),e.EFF(7),e.nI1(8,"abpLocalization"),e.k0s(),e.nrm(9,"input",8),e.k0s(),e.j41(10,"div",6)(11,"label",9),e.EFF(12),e.nI1(13,"abpLocalization"),e.k0s(),e.nrm(14,"input",10),e.k0s(),e.j41(15,"div",6)(16,"label",11),e.EFF(17),e.nI1(18,"abpLocalization"),e.k0s(),e.nrm(19,"input",12),e.k0s(),e.j41(20,"div",6)(21,"label",13),e.EFF(22),e.nI1(23,"abpLocalization"),e.k0s(),e.nrm(24,"input",14),e.k0s(),e.j41(25,"div",6)(26,"label",15),e.EFF(27),e.nI1(28,"abpLocalization"),e.k0s(),e.nrm(29,"input",16),e.k0s(),e.j41(30,"div",17)(31,"label",18),e.EFF(32),e.nI1(33,"abpLocalization"),e.k0s(),e.nrm(34,"input",19),e.k0s()()}if(2&t){const i=e.XpG();e.R7$(2),e.SpI(" ",e.bMT(3,8,"AbpOpenIddict::TokenLifetimeHit")," "),e.R7$(2),e.Y8G("formGroup",i.form),e.R7$(3),e.SpI(" ",e.bMT(8,10,"AbpOpenIddict::AccessTokenLifetime")," "),e.R7$(5),e.SpI(" ",e.bMT(13,12,"AbpOpenIddict::AuthorizationCodeLifetime")," "),e.R7$(5),e.SpI(" ",e.bMT(18,14,"AbpOpenIddict::DeviceCodeLifetime")," "),e.R7$(5),e.SpI(" ",e.bMT(23,16,"AbpOpenIddict::IdentityTokenLifetime")," "),e.R7$(5),e.SpI(" ",e.bMT(28,18,"AbpOpenIddict::RefreshTokenLifetime")," "),e.R7$(5),e.SpI(" ",e.bMT(33,20,"AbpOpenIddict::UserCodeLifetime")," ")}}function Ae(t,s){if(1&t&&(e.j41(0,"button",20),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s(),e.j41(3,"abp-button",21),e.EFF(4),e.nI1(5,"abpLocalization"),e.k0s()),2&t){const i=e.XpG();e.R7$(),e.SpI(" ",e.bMT(2,3,"AbpOpenIddict::Cancel")," "),e.R7$(2),e.Y8G("disabled",i.loading()),e.R7$(),e.SpI("",e.bMT(5,5,"AbpOpenIddict::Save")," ")}}function _e(t,s){if(1&t&&(e.j41(0,"h3"),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s()),2&t){const i=e.XpG(2);e.R7$(),e.SpI(" ",e.bMT(2,1,null!=i.selected&&i.selected.id?"AbpOpenIddict::Edit":"AbpOpenIddict::NewApplication")," ")}}function Ce(t,s){if(1&t){const i=e.RV6();e.j41(0,"form",5),e.bIt("ngSubmit",function(){e.eBV(i);const n=e.XpG(2);return e.Njj(n.save())}),e.j41(1,"div",6),e.nrm(2,"abp-extensible-form",7),e.k0s()()}if(2&t){const i=e.XpG(2);e.Y8G("formGroup",i.form),e.R7$(2),e.Y8G("selectedRecord",i.selected)}}function ge(t,s){1&t&&(e.j41(0,"button",8),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s(),e.j41(3,"abp-button",9),e.EFF(4),e.nI1(5,"abpLocalization"),e.k0s()),2&t&&(e.R7$(),e.SpI(" ",e.bMT(2,2,"AbpOpenIddict::Cancel")," "),e.R7$(3),e.JRh(e.bMT(5,4,"AbpOpenIddict::Save")))}function ye(t,s){if(1&t){const i=e.RV6();e.j41(0,"abp-modal",4),e.bIt("visibleChange",function(n){e.eBV(i);const l=e.XpG();return e.Njj(l.visibleChange(n))}),e.DNE(1,_e,3,3,"ng-template",null,0,e.C5r)(3,Ce,3,2,"ng-template",null,1,e.C5r)(5,ge,6,6,"ng-template",null,2,e.C5r),e.k0s()}if(2&t){const i=e.XpG();e.Y8G("visible",!0)("options",i.options)}}const Se=()=>({value:"C"}),Pe=t=>({value:t}),Ne=t=>({value:t,twoWay:!0}),Re=(t,s,i)=>({providerName:t,providerKey:s,visible:i}),Fe=t=>({visibleChange:t}),Ee=(t,s)=>({inputs:t,outputs:s,componentKey:"PermissionManagement.PermissionManagementComponent"});function Me(t,s){if(1&t&&e.nrm(0,"abp-token-lifetime-modal",6),2&t){const i=e.XpG();e.Y8G("selected",i.selected())}}function Le(t,s){if(1&t){const i=e.RV6();e.j41(0,"abp-permission-management",8),e.mxI("visibleChange",function(n){e.eBV(i);const l=e.XpG();return e.DH7(l.visiblePermissions,n)||(l.visiblePermissions=n),e.Njj(n)}),e.k0s()}if(2&t){const i=e.XpG();e.R50("visible",i.visiblePermissions),e.Y8G("providerKey",i.providerKey)}}function De(t,s){if(1&t&&(e.j41(0,"h3"),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s()),2&t){const i=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,null!=i.selected&&i.selected.id?"AbpOpenIddict::Edit":"AbpOpenIddict::NewScope"))}}function ke(t,s){if(1&t){const i=e.RV6();e.j41(0,"form",4),e.bIt("ngSubmit",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.save())}),e.nrm(1,"abp-extensible-form",5),e.k0s()}if(2&t){const i=e.XpG();e.Y8G("formGroup",i.form)("blueprints",i.blueprints),e.R7$(),e.Y8G("selectedRecord",i.selected)}}function je(t,s){1&t&&(e.j41(0,"button",6),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s(),e.j41(3,"abp-button",7),e.EFF(4),e.nI1(5,"abpLocalization"),e.k0s()),2&t&&(e.R7$(),e.SpI(" ",e.bMT(2,2,"AbpOpenIddict::Cancel")," "),e.R7$(3),e.JRh(e.bMT(5,4,"AbpOpenIddict::Save")))}class S{constructor(){this.state=new p.JG$({isModalVisible:!1}),this.#e=(0,e.vPA)(!1),this.isModalVisible=(0,e.EWP)(()=>this.#e()),this.#t=(0,e.vPA)(!1),this.isTokenLifetimeModalVisible=(0,e.EWP)(()=>this.#t())}#e;#t;openModal(){this.setModalState(!0)}setModalState(s){this.#e.set(s)}setTokenLifetimeModalState(s){this.#t.set(s)}}class N{constructor(){this.state=new p.JG$({isModalVisible:!1}),this.isModalVisible$=this.state.sliceState(s=>s.isModalVisible)}openModal(){this.setModalState(!0)}setModalState(s){this.state.patch({isModalVisible:s})}}let x=(()=>{class t{constructor(){this.#e=(0,e.WQX)(S),this.#t=(0,e.WQX)(j),this.saved=new e.bkB,this.loading=(0,e.vPA)(!1),this.#i=(0,e.WQX)(m.ok),this.toasterService=(0,e.WQX)(d.W9),this.form=this.#i.group({accessTokenLifetime:[null],authorizationCodeLifetime:[null],deviceCodeLifetime:[null],identityTokenLifetime:[null],refreshTokenLifetime:[null],userCodeLifetime:[null]})}#e;#t;#i;save(){this.form.invalid||this.#t.setTokenLifetime(this.selected.id,this.form.value).pipe((0,be.j)(()=>{this.#e.setTokenLifetimeModalState(!1),this.toasterService.success("AbpUi::SavedSuccessfully"),this.saved.emit()})).subscribe()}visibleChange(i){i||this.#e.setTokenLifetimeModalState(!1)}ngOnInit(){this.#t.getTokenLifetime(this.selected.id).subscribe(i=>{this.form.patchValue(i)})}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["abp-token-lifetime-modal"]],inputs:{selected:"selected"},outputs:{saved:"saved"},standalone:!0,features:[e.aNF],decls:7,vars:1,consts:[["abpHeader",""],["abpBody",""],["abpFooter",""],[3,"visibleChange","visible"],[1,"mb-3"],["id","applicationForm","validateOnSubmit","",3,"ngSubmit","formGroup"],[1,"form-group","mb-3"],["for","accessTokenLifetime",1,"form-label"],["type","number","id","accessTokenLifetime","formControlName","accessTokenLifetime",1,"form-control"],["for","authorizationCodeLifetime",1,"form-label"],["type","number","id","authorizationCodeLifetime","formControlName","authorizationCodeLifetime",1,"form-control"],["for","deviceCodeLifetime",1,"form-label"],["type","number","id","deviceCodeLifetime","formControlName","deviceCodeLifetime",1,"form-control"],["for","identityTokenLifetime",1,"form-label"],["type","number","id","identityTokenLifetime","formControlName","identityTokenLifetime",1,"form-control"],["for","refreshTokenLifetime",1,"form-label"],["type","number","id","refreshTokenLifetime","formControlName","refreshTokenLifetime",1,"form-control"],[1,"form-group"],["for","userCodeLifetime",1,"form-label"],["type","number","id","userCodeLifetime","formControlName","userCodeLifetime",1,"form-control"],["type","button","abpClose","",1,"btn","btn-outline-primary"],["iconClass","fa fa-check","buttonType","submit","formName","applicationForm",3,"disabled"]],template:function(o,n){if(1&o){const l=e.RV6();e.j41(0,"abp-modal",3),e.bIt("visibleChange",function(f){return e.eBV(l),e.Njj(n.visibleChange(f))}),e.DNE(1,Oe,3,3,"ng-template",null,0,e.C5r)(3,ve,35,22,"ng-template",null,1,e.C5r)(5,Ae,6,7,"ng-template",null,2,e.C5r),e.k0s()}2&o&&e.Y8G("visible",!0)},dependencies:[Z.MD,d.Ts,y.a5,y.lt,d.Qp,d.zf,d.b6,p.Ui,m.qT,m.me,m.Q0,m.BC,m.cb,m.j4,m.JD,p.aM3,p.S02],encapsulation:2})}}return t})();const ee=[{key:"Confidential client",value:"confidential"},{key:"Public client",value:"public"}],_={public:"public",confidential:"confidential"},te=[{key:"Web",value:"web"},{key:"Native",value:"native"}],Ve=/\r?\n/,we="\n";function v(t){return Array.isArray(t)?t.join(we):"string"==typeof t?t?t.split(Ve):null:t}const ie=[{key:"Explicit consent",value:"explicit"},{key:"External consent",value:"external"},{key:"Implicit consent",value:"implicit"},{key:"Systematic consent",value:"systematic"}];let u=(()=>{class t{constructor(){this.service=(0,e.WQX)(j),this.applicationsService=(0,e.WQX)(S),this.localizationService=(0,e.WQX)(p.PiF),this.subscription=(0,e.WQX)(p.nCQ),this.injector=(0,e.WQX)(e.zZn),this.toasterService=(0,e.WQX)(d.W9),this.saved=new e.bkB,this.types$=(0,w.of)(ee),this.consentTypes$=(0,w.of)(ie),this.options={size:"lg"},this.isModalVisible=this.applicationsService.isModalVisible}ngOnChanges(){this.createForm(),this.hideFlowToType()}visibleChange(i){this.applicationsService.setModalState(i)}save(){if(this.form.invalid)return;const i=this.selected?.id,o=!!i;let n;const l=f=>Array.isArray(f)?f:v(f),I={...this.form.value,redirectUris:l(this.form.value.redirectUris),postLogoutRedirectUris:l(this.form.value.postLogoutRedirectUris),extensionGrantTypes:l(this.form.value.extensionGrantTypes)};n=o?this.service.update(i,I):this.service.create(I),n.subscribe(()=>{this.applicationsService.setModalState(!1),this.toasterService.success("AbpUi::SavedSuccessfully"),this.saved.emit()})}getFormValue(){return this.form?.value||{}}createForm(){const i=this.selected?.id?{...this.selected,redirectUris:v(this.selected.redirectUris),postLogoutRedirectUris:v(this.selected.postLogoutRedirectUris),extensionGrantTypes:v(this.selected.extensionGrantTypes)}:{clientType:null},o=new a.a9(this.injector,i);this.form=(0,a.uB)(o)}hideFlowToType(){const i=this.form.controls.clientType;this.subscription.removeOne(this.formValueChanges$),this.formValueChanges$=this.subscription.addOne(i.valueChanges,o=>{o==_.public&&this.form.patchValue({allowDeviceEndpoint:!1,allowClientCredentialsFlow:!1})})}changeTextToType(i){return this.getFormValue().clientType===_.public?this.localizationService.instant(i)+" ("+this.localizationService.instant("AbpOpenIddict::NotAvailableForThisType")+")":this.localizationService.instant(i)}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["abp-application-form-modal"]],inputs:{selected:"selected"},outputs:{saved:"saved"},features:[e.OA$],decls:1,vars:1,consts:[["abpHeader",""],["abpBody",""],["abpFooter",""],[3,"visible","options"],[3,"visibleChange","visible","options"],["id","applicationForm","validateOnSubmit","",3,"ngSubmit","formGroup"],[1,"row"],[1,"row","gap-x2",3,"selectedRecord"],["type","button","abpClose","",1,"btn","btn-outline-primary"],["iconClass","fa fa-check","buttonType","submit","formName","applicationForm"]],template:function(o,n){1&o&&e.DNE(0,ye,7,2,"abp-modal",3),2&o&&e.vxM(n.isModalVisible()?0:-1)},dependencies:[m.qT,m.cb,m.j4,p.S02,a.X3,y.a5,d.Qp,d.zf,d.b6,p.aM3],encapsulation:2})}}return t})(),T=(()=>{class t{constructor(){this.service=(0,e.WQX)(S),this.list=(0,e.WQX)(p.aGM),this.confirmationService=(0,e.WQX)(d.td),this.proxyService=(0,e.WQX)(j),this.toasterService=(0,e.WQX)(d.W9),this.data={items:[],totalCount:0},this.selected=(0,e.vPA)({}),this.visiblePermissions=!1,this.onVisiblePermissionChange=i=>{this.visiblePermissions=i}}onSaved(){this.list.get()}edit(i){this.proxyService.get(i).subscribe(o=>{this.selected.set(o),this.service.openModal()})}delete(i,o){this.confirmationService.warn("AbpOpenIddict::ApplicationDeletionWarningMessage","AbpOpenIddict::AreYouSure",{messageLocalizationParams:[o]}).pipe((0,fe.p)(n=>n===d.m.Status.confirm),(0,he.n)(()=>this.proxyService.delete(i))).subscribe(()=>{this.toasterService.success("AbpUi::DeletedSuccessfully"),this.list.get()})}ngOnInit(){this.hookToQuery()}onAdd(){this.selected.set({}),this.service.openModal()}openPermissionsModal(i){this.providerKey=i,setTimeout(()=>{this.visiblePermissions=!0},0)}hookToQuery(){this.list.hookToQuery(i=>this.proxyService.getList(i)).subscribe(i=>this.data=i)}openTokenLifetimeModal(i){this.selected.set(i),this.service.setTokenLifetimeModalState(!0)}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["abp-applications"]],features:[e.Jv_([p.aGM,{provide:a.JF,useValue:"OpenIddictPro.Applications"}])],decls:9,vars:25,consts:[[3,"title","toolbar"],["id","wrapper"],["localizationSourceName","AbpOpenIddict",3,"list"],[1,"card"],[3,"data","recordsTotal","list"],[3,"saved","selected"],[3,"selected"],["providerName","C",3,"visible","providerKey","visibleChange",4,"abpReplaceableTemplate"],["providerName","C",3,"visibleChange","visible","providerKey"]],template:function(o,n){1&o&&(e.j41(0,"abp-page",0),e.nI1(1,"abpLocalization"),e.j41(2,"div",1),e.nrm(3,"abp-advanced-entity-filters",2),e.j41(4,"div",3),e.nrm(5,"abp-extensible-table",4),e.k0s()()(),e.j41(6,"abp-application-form-modal",5),e.bIt("saved",function(){return n.onSaved()}),e.k0s(),e.DNE(7,Me,1,1,"abp-token-lifetime-modal",6)(8,Le,1,2,"abp-permission-management",7)),2&o&&(e.Y8G("title",e.bMT(1,9,"AbpOpenIddict::Applications"))("toolbar",n.data.items),e.R7$(3),e.Y8G("list",n.list),e.R7$(2),e.Y8G("data",n.data.items)("recordsTotal",n.data.totalCount)("list",n.list),e.R7$(),e.Y8G("selected",n.selected()),e.R7$(),e.vxM(n.service.isTokenLifetimeModalVisible()?7:-1),e.R7$(),e.Y8G("abpReplaceableTemplate",e.l_i(22,Ee,e.sMw(16,Re,e.lJ4(11,Se),e.eq3(12,Pe,n.providerKey),e.eq3(14,Ne,n.visiblePermissions)),e.eq3(20,Fe,n.onVisiblePermissionChange))))},dependencies:[p.y98,a.XY,O.Is,U.H1,q.i,x,u,p.aM3],encapsulation:2})}}return t})(),G=(()=>{class t{constructor(){this.injector=(0,e.WQX)(e.zZn),this.scopesService=(0,e.WQX)(N),this.service=(0,e.WQX)(V),this.toasterService=(0,e.WQX)(d.W9),this.saved=new e.bkB,this.blueprints={pattern:"AbpOpenIddict::TheScopeNameCannotContainSpaces"},this.isModalVisible$=this.scopesService.isModalVisible$}ngOnChanges(i){this.createForm()}save(){if(this.form.invalid)return;const i=this.selected.id,o=!!i;let n;const l={...this.form.value,resources:v(this.form.value.resources)};n=o?this.service.update(i,l):this.service.create(l),n.subscribe(()=>{this.scopesService.setModalState(!1),this.toasterService.success("AbpUi::SavedSuccessfully"),this.saved.emit()})}visibleChange(i){this.scopesService.setModalState(i)}createForm(){const i=this.selected?.id?{...this.selected,resources:v(this.selected.resources)}:{},o=new a.a9(this.injector,i);this.form=(0,a.uB)(o)}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["abp-scope-form-modal"]],inputs:{selected:"selected"},outputs:{saved:"saved"},features:[e.OA$],decls:8,vars:3,consts:[["abpHeader",""],["abpBody",""],["abpFooter",""],[3,"visibleChange","visible"],["id","scopeForm","validateOnSubmit","",3,"ngSubmit","formGroup","blueprints"],[3,"selectedRecord"],["type","button","abpClose","",1,"btn","btn-outline-primary"],["iconClass","fa fa-check","buttonType","submit","formName","scopeForm"]],template:function(o,n){if(1&o){const l=e.RV6();e.j41(0,"abp-modal",3),e.nI1(1,"async"),e.bIt("visibleChange",function(f){return e.eBV(l),e.Njj(n.visibleChange(f))}),e.DNE(2,De,3,3,"ng-template",null,0,e.C5r)(4,ke,2,3,"ng-template",null,1,e.C5r)(6,je,6,6,"ng-template",null,2,e.C5r),e.k0s()}2&o&&e.Y8G("visible",e.bMT(1,1,n.isModalVisible$))},dependencies:[m.qT,m.cb,m.j4,p.S02,a.X3,y.a5,d.Qp,d.zf,d.b6,Z.Jj,p.aM3],encapsulation:2})}}return t})(),C=(()=>{class t{constructor(){this.list=(0,e.WQX)(p.aGM),this.confirmationService=(0,e.WQX)(d.td),this.toasterService=(0,e.WQX)(d.W9),this.service=(0,e.WQX)(V),this.scopesService=(0,e.WQX)(N),this.data={items:[],totalCount:0},this.selected={}}hookToQuery(){this.list.hookToQuery(i=>this.service.getList(i)).subscribe(i=>this.data=i)}ngOnInit(){this.hookToQuery()}onAdd(){this.selected={},this.scopesService.openModal()}onEdit(i){this.service.get(i).subscribe(o=>{this.selected=o,this.scopesService.openModal()})}onDelete(i,o){this.confirmationService.warn("AbpOpenIddict::ScopeDeletionWarningMessage","AbpOpenIddict::AreYouSure",{messageLocalizationParams:[o]}).subscribe(l=>{l===d.m.Status.confirm&&this.service.delete(i).subscribe(()=>{this.toasterService.success("AbpUi::DeletedSuccessfully"),this.list.get()})})}onSaved(){this.list.get()}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["abp-scopes"]],features:[e.Jv_([p.aGM,{provide:a.JF,useValue:"OpenIddictPro.Scopes"}])],decls:7,vars:9,consts:[[3,"title","toolbar"],["id","wrapper"],["localizationSourceName","AbpOpenIddict",3,"list"],[1,"card"],[3,"data","recordsTotal","list"],[3,"saved","selected"]],template:function(o,n){1&o&&(e.j41(0,"abp-page",0),e.nI1(1,"abpLocalization"),e.j41(2,"div",1),e.nrm(3,"abp-advanced-entity-filters",2),e.j41(4,"div",3),e.nrm(5,"abp-extensible-table",4),e.k0s()()(),e.j41(6,"abp-scope-form-modal",5),e.bIt("saved",function(){return n.onSaved()}),e.k0s()),2&o&&(e.Y8G("title",e.bMT(1,7,"AbpOpenIddict::Scopes"))("toolbar",n.data.items),e.R7$(3),e.Y8G("list",n.list),e.R7$(2),e.Y8G("data",n.data.items)("recordsTotal",n.data.totalCount)("list",n.list),e.R7$(),e.Y8G("selected",n.selected))},dependencies:[a.XY,O.Is,U.H1,G,p.aM3],encapsulation:2})}}return t})();const oe=a.SY.createMany([{text:"AbpOpenIddict::Edit",action:t=>{t.getInjected(T).edit(t.record.id)},permission:"OpenIddictPro.Application.Update"},{text:"AbpOpenIddict::TokenLifetime",action:t=>{t.getInjected(T).openTokenLifetimeModal(t.record)},permission:"OpenIddictPro.Application.Update"},{text:"AbpOpenIddict::ChangeHistory",action:t=>{t.getInjected(O.BQ)(t.record.id,"Volo.Abp.OpenIddict.Applications.OpenIddictApplication")},permission:"AuditLogging.ViewChangeHistory:Volo.Abp.OpenIddict.Pro.Applications.Application"},{text:"AbpOpenIddict::Permissions",action:t=>{t.getInjected(T).openPermissionsModal(t.record.clientId)},permission:"OpenIddictPro.Application.ManagePermissions"},{text:"LanguageManagement::Delete",action:t=>{t.getInjected(T).delete(t.record.id,t.record.clientId)},permission:"LanguageManagement.Languages.Delete"}]),ne=a.Fh.createMany([{type:"string",name:"applicationType",displayName:"AbpOpenIddict::ApplicationType",columnWidth:100},{type:"string",name:"clientId",displayName:"AbpOpenIddict::ClientId",columnWidth:200},{type:"string",name:"displayName",displayName:"AbpOpenIddict::DisplayName",columnWidth:100},{type:"string",name:"clientType",displayName:"AbpOpenIddict::ClientType",columnWidth:200}]),se=a.KR.createMany([{text:"AbpOpenIddict::NewApplication",action:t=>{t.getInjected(T).onAdd()},permission:"OpenIddictPro.Application.Create",icon:"fa fa-plus"}]),ae=/^([a-z][a-z0-9+.-]*):(?:\/\/((?:(?=((?:[a-z0-9-._~!$&'()*+,;=:]|%[0-9A-F]{2})*))(\3)@)?(?=(\[[0-9A-F:.]{2,}\]|(?:[a-z0-9-._~!$&'()*+,;=]|%[0-9A-F]{2})*))\5(?::(?=(\d*))\6)?)(\/(?=((?:[a-z0-9-._~!$&'()*+,;=:@\/]|%[0-9A-F]{2})*))\8)?|(\/?(?!\/)(?=((?:[a-z0-9-._~!$&'()*+,;=:@\/]|%[0-9A-F]{2})*))\10)?)(?:\?(?=((?:[a-z0-9-._~!$&'()*+,;=:@\/?]|%[0-9A-F]{2})*))\11)?(?:#(?=((?:[a-z0-9-._~!$&'()*+,;=:@\/?]|%[0-9A-F]{2})*))\12)?$/i,Ue=/(\r\n|\r|\n)/;function R(){const t=ae;return s=>{if(function xe(t){return null==t||("string"==typeof t||Array.isArray(t))&&0===t.length}(s.value))return null;const i=s.value,o=i.split(Ue).filter(l=>!!l.trim());return 0===o.length||o.every(l=>t.test(l))?null:{url:t.toString(),actualValue:i}}}const F=({allowImplicitFlow:t,allowAuthorizationCodeFlow:s,allowHybridFlow:i})=>s||t||i,A={name:"left",className:"col col-md-6"},b={name:"right",className:"col col-md-6"},c="mb-1 form-group",$=a.UW.createMany([{type:"string",options:t=>(0,w.of)(te),name:"applicationType",displayName:"AbpOpenIddict::ApplicationType",id:"applicationType",group:A,className:c,validators:()=>[m.k0.required]},{type:"string",name:"clientId",displayName:"AbpOpenIddict::ClientId",id:"clientId",validators:()=>[m.k0.required],group:A,className:c},{type:"string",name:"displayName",displayName:"AbpOpenIddict::DisplayName",id:"displayName",validators:()=>[m.k0.required],group:A,className:c},{type:"string",name:"clientUri",displayName:"AbpOpenIddict::ClientUri",id:"clientUri",validators:()=>[R()],group:A,className:c},{type:"string",name:"logoUri",displayName:"AbpOpenIddict::LogoUri",id:"logoUri",group:A,className:c},{type:"string",name:"clientType",displayName:"AbpOpenIddict::ClientType",id:"clientType",validators:()=>[m.k0.required],options:t=>{const s=t.getInjected(p.PiF).instant("AbpUi::NotAssigned");return t.getInjected(u).types$.pipe((0,P.T)(i=>[{key:s,value:null},...i]))},group:A,className:c},{type:"string",name:"clientSecret",displayName:"AbpOpenIddict::ClientSecret",id:"clientSecret",visible:t=>t.getInjected(u).getFormValue().clientType===_.confidential,group:A,className:c},{type:"boolean",defaultValue:!1,name:"allowAuthorizationCodeFlow",displayName:"AbpOpenIddict::AllowAuthorizationCodeFlow",id:"allowAuthorizationCodeFlow",group:b,className:c},{type:"boolean",defaultValue:!1,name:"allowImplicitFlow",displayName:"AbpOpenIddict::AllowImplicitFlow",id:"allowImplicitFlow",group:b,className:c},{type:"boolean",defaultValue:!1,name:"allowHybridFlow",displayName:"AbpOpenIddict::AllowHybridFlow",id:"allowHybridFlow",group:b,className:c},{type:"boolean",defaultValue:!1,name:"allowPasswordFlow",displayName:"AbpOpenIddict::AllowPasswordFlow",id:"allowPasswordFlow",group:b,className:c},{type:"boolean",defaultValue:!1,name:"allowClientCredentialsFlow",displayTextResolver:t=>t.getInjected(u).changeTextToType("AbpOpenIddict::AllowClientCredentialsFlow"),disabled:t=>t.getInjected(u).getFormValue().type===_.public,id:"allowClientCredentialsFlow",group:b,className:c},{type:"boolean",defaultValue:!1,name:"allowRefreshTokenFlow",displayName:"AbpOpenIddict::AllowRefreshTokenFlow",disabled:t=>{const{allowHybridFlow:s,allowAuthorizationCodeFlow:i,allowPasswordFlow:o}=t.getInjected(u).getFormValue();return!(s||i||o)},id:"allowRefreshTokenFlow",group:b,className:c},{type:"boolean",defaultValue:!1,name:"allowDeviceEndpoint",displayTextResolver:t=>t.getInjected(u).changeTextToType("AbpOpenIddict::AllowDeviceEndpoint"),disabled:t=>t.getInjected(u).getFormValue().type===_.public,id:"allowDeviceEndpoint",group:b,className:c},{type:"string",name:"consentType",displayName:"AbpOpenIddict::ConsentType",id:"consentType",options:t=>t.getInjected(u).consentTypes$,visible:t=>{const s=t.getInjected(u).getFormValue();return F(s)},group:b,className:c},{type:"text",name:"extensionGrantTypes",displayName:"AbpOpenIddict::ExtensionGrantTypes",id:"extensionGrantTypes",className:c,group:b},{type:"multiselect",name:"scopes",displayName:"AbpOpenIddict::Scopes",id:"scopes",defaultValue:[],options:t=>t.getInjected(V).getAllScopes().pipe((0,P.T)(s=>s.map(i=>({key:i.name,value:i.name})))),group:b,className:c},{type:"text",name:"redirectUris",displayName:"AbpOpenIddict::RedirectUris",id:"redirectUris",validators:()=>[R()],visible:t=>{const s=t.getInjected(u).getFormValue();return F(s)},group:b,className:c},{type:"boolean",defaultValue:!1,name:"allowLogoutEndpoint",displayName:"AbpOpenIddict::AllowLogoutEndpoint",id:"allowLogoutEndpoint",visible:t=>{const s=t.getInjected(u).getFormValue();return F(s)},group:b,className:c},{type:"text",name:"postLogoutRedirectUris",displayName:"AbpOpenIddict::PostLogoutRedirectUris",id:"postLogoutRedirectUris",validators:()=>[R()],visible:t=>{const{allowLogoutEndpoint:s}=t.getInjected(u).getFormValue();return s},group:b,className:c}]),le=$.concat(a.UW.createMany([{type:"boolean",name:"enabled",displayName:"AbpOpenIddict::Enabled",id:"enabled",defaultValue:!1,group:b,className:c}])),pe=a.Fh.createMany([{type:"string",name:"name",displayName:"AbpOpenIddict::Name",columnWidth:200},{type:"string",name:"displayName",displayName:"AbpOpenIddict::DisplayName",columnWidth:200},{type:"string",name:"description",displayName:"AbpOpenIddict::Description",columnWidth:200}]),re=a.KR.createMany([{text:"AbpOpenIddict::NewScope",action:t=>{t.getInjected(C).onAdd()},permission:"OpenIddictPro.Scope.Create",icon:"fa fa-plus"}]),z=a.UW.createMany([{type:"string",name:"name",displayName:"AbpOpenIddict::Name",id:"name",validators:()=>[m.k0.required,m.k0.pattern(/^\S+$/)]},{type:"string",name:"displayName",displayName:"AbpOpenIddict::DisplayName",id:"displayName"},{type:"string",name:"description",displayName:"AbpOpenIddict::Description",id:"description"},{type:"text",name:"resources",displayName:"AbpOpenIddict::Resources",id:"resources"}]),ce=z,de=a.SY.createMany([{text:"AbpOpenIddict::Edit",action:t=>{t.getInjected(C).onEdit(t.record.id)},permission:"OpenIddictPro.Scope.Update"},{text:"AbpOpenIddict::ChangeHistory",action:t=>{t.getInjected(O.BQ)(t.record.id,"Volo.Abp.OpenIddict.Scopes.OpenIddictScope")},permission:"AuditLogging.ViewChangeHistory:Volo.Abp.OpenIddict.Pro.Scopes.Scope",visible:t=>!!t.getInjected(O.BQ,null)},{text:"AbpOpenIddict::Delete",action:t=>{t.getInjected(C).onDelete(t.record.id,t.record.name)},permission:"OpenIddictPro.Scope.Delete"}]),B={"OpenIddictPro.Applications":oe,"OpenIddictPro.Scopes":de},W={"OpenIddictPro.Applications":se,"OpenIddictPro.Scopes":re},Y={"OpenIddictPro.Applications":ne,"OpenIddictPro.Scopes":pe},X={"OpenIddictPro.Applications":$,"OpenIddictPro.Scopes":z},Q={"OpenIddictPro.Applications":le,"OpenIddictPro.Scopes":ce},E=new e.nKC("OPENIDDICT_PRO_ENTITY_ACTION_CONTRIBUTORS"),M=new e.nKC("OPENIDDICT_PRO__TOOLBAR_ACTION_CONTRIBUTORS"),L=new e.nKC("OPENIDDICT_PRO_ENTITY_PROP_CONTRIBUTORS"),D=new e.nKC("OPENIDDICT_PRO_CREATE_FORM_PROP_CONTRIBUTORS"),k=new e.nKC("OPENIDDICT_PRO_EDIT_FORM_PROP_CONTRIBUTORS"),$e=[{path:"",redirectTo:"Applications",pathMatch:"full"},{path:"",component:p.Cs_,canActivate:[p.W_R,p.RH_],resolve:[()=>{const t=(0,e.WQX)(e.zZn),s=t.get(a.yJ),i=t.get(E,null)||{},o=t.get(M,null)||{},n=t.get(L,null)||{},l=t.get(D,null)||{},I=t.get(k,null)||{},f=t.get(p.d14);return(0,a.Nl)(f,"OpenIddictPro").pipe((0,P.T)(h=>({"OpenIddictPro.Applications":h.ApiResource,"OpenIddictPro.Scopes":h.Scopes})),(0,a.p2)(f,"AbpOpenIddictPro"),(0,J.M)(h=>{(0,a.xB)(s.entityActions,B,i),(0,a.xB)(s.toolbarActions,W,o),(0,a.ah)(s.entityProps,Y,h.prop,n),(0,a.ah)(s.createFormProps,X,h.createForm,l),(0,a.ah)(s.editFormProps,Q,h.editForm,I)}))}],children:[{path:"Applications",component:p.yFO,data:{requiredPolicy:"OpenIddictPro.Application",replaceableComponent:{key:"OpenIddictPro.Applications",defaultComponent:T}},title:"AbpOpenIddict::Applications"},{path:"Scopes",component:p.yFO,data:{requiredPolicy:"OpenIddictPro.Scopes",replaceableComponent:{key:"OpenIddictPro.Scopes",defaultComponent:C}},title:"AbpOpenIddict::Scopes"}]}];let ze=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275mod=e.$C({type:t})}static{this.\u0275inj=e.G2t({imports:[K.iI.forChild($e),K.iI]})}}return t})(),Be=(()=>{class t{static forChild(i={}){return{ngModule:t,providers:[{provide:E,useValue:i.entityActionContributors},{provide:M,useValue:i.toolbarActionContributors},{provide:L,useValue:i.entityPropContributors},{provide:D,useValue:i.createFormPropContributors},{provide:k,useValue:i.editFormPropContributors},S,N]}}static forLazy(i={}){return new p.l37(t.forChild(i))}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275mod=e.$C({type:t})}static{this.\u0275inj=e.G2t({imports:[ze,p.Ui,O.pY,d.Ts,Ie.zH,y.fs,U.wq,O.Fl,q.D,a.X3,x,a.XY]})}}return t})(),We=(()=>{class t{constructor(i){this.injector=i}canActivate(){const i=this.injector.get(a.yJ),o=this.injector.get(E,null)||{},n=this.injector.get(M,null)||{},l=this.injector.get(L,null)||{},I=this.injector.get(D,null)||{},f=this.injector.get(k,null)||{},h=this.injector.get(p.d14);return(0,a.Nl)(h,"OpenIddictPro").pipe((0,P.T)(g=>({"OpenIddictPro.Applications":g.ApiResource,"OpenIddictPro.Scopes":g.Scopes})),(0,a.p2)(h,"AbpOpenIddictPro"),(0,J.M)(g=>{(0,a.xB)(i.entityActions,B,o),(0,a.xB)(i.toolbarActions,W,n),(0,a.ah)(i.entityProps,Y,g.prop,l),(0,a.ah)(i.createFormProps,X,g.createForm,I),(0,a.ah)(i.editFormProps,Q,g.editForm,f)}),(0,Te.u)(!0))}static{this.\u0275fac=function(o){return new(o||t)(e.KVO(e.zZn))}}static{this.\u0275prov=e.jDH({token:t,factory:t.\u0275fac})}}return t})()}}]);