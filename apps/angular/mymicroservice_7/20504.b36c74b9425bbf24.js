"use strict";(self.webpackChunkmymicroservice_7=self.webpackChunkmymicroservice_7||[]).push([[20504],{20504:(an,Z,u)=>{u.r(Z),u.d(Z,{ConnectionStringsComponent:()=>j,DEFAULT_EDITIONS_ENTITY_ACTIONS:()=>be,DEFAULT_EDITIONS_ENTITY_PROPS:()=>he,DEFAULT_EDITIONS_FORM_PROPS:()=>z,DEFAULT_EDITIONS_TOOLBAR_ACTIONS:()=>ge,DEFAULT_SAAS_CREATE_FORM_PROPS:()=>H,DEFAULT_SAAS_EDIT_FORM_PROPS:()=>K,DEFAULT_SAAS_ENTITY_ACTIONS:()=>W,DEFAULT_SAAS_ENTITY_PROPS:()=>J,DEFAULT_SAAS_TOOLBAR_ACTIONS:()=>Q,DEFAULT_TENANTS_CREATE_FORM_PROPS:()=>k,DEFAULT_TENANTS_EDIT_FORM_PROPS:()=>Se,DEFAULT_TENANTS_ENTITY_ACTIONS:()=>fe,DEFAULT_TENANTS_ENTITY_PROPS:()=>Te,DEFAULT_TENANTS_TOOLBAR_ACTIONS:()=>ve,EditionDeleteComponent:()=>de,EditionDeleteValidator:()=>ce,EditionsComponent:()=>S,EditionsUsageWidgetComponent:()=>Ce,ImpersonateTenantModalComponent:()=>q,ImpersonateTenantModalService:()=>Y,LatestTenantsWidgetComponent:()=>Ee,MoveAllTenantsComponent:()=>pe,SAAS_CREATE_FORM_PROP_CONTRIBUTORS:()=>G,SAAS_EDIT_FORM_PROP_CONTRIBUTORS:()=>L,SAAS_ENTITY_ACTION_CONTRIBUTORS:()=>x,SAAS_ENTITY_PROP_CONTRIBUTORS:()=>V,SAAS_TOOLBAR_ACTION_CONTRIBUTORS:()=>O,SaasExtensionsGuard:()=>qt,SaasModule:()=>tn,SetTenantPasswordModalComponent:()=>X,TENANT_ACTIVATION_STATE_VALIDATOR_PROVIDER:()=>ue,TENANT_FORM_VALIDATORS_TOKEN:()=>B,TenantsComponent:()=>f,defaultDateFormatRegex:()=>nn,saasExtensionsResolver:()=>Fe,sharedDatabaseValidator:()=>me,tenantActivationStateValidator:()=>_e});var ee=u(74523),e=u(93953),C=u(60177),d=u(39862),l=u(30791);let N=(()=>{class n{constructor(t){this.restService=t,this.apiName="SaasHost",this.create=(i,a)=>this.restService.request({method:"POST",url:"/api/saas/editions",body:i},{apiName:this.apiName,...a}),this.delete=(i,a)=>this.restService.request({method:"DELETE",url:`/api/saas/editions/${i}`},{apiName:this.apiName,...a}),this.get=(i,a)=>this.restService.request({method:"GET",url:`/api/saas/editions/${i}`},{apiName:this.apiName,...a}),this.getAllList=i=>this.restService.request({method:"GET",url:"/api/saas/editions/all"},{apiName:this.apiName,...i}),this.getList=(i,a)=>this.restService.request({method:"GET",url:"/api/saas/editions",params:{filter:i.filter,sorting:i.sorting,skipCount:i.skipCount,maxResultCount:i.maxResultCount}},{apiName:this.apiName,...a}),this.getPlanLookup=i=>this.restService.request({method:"GET",url:"/api/saas/editions/plan-lookup"},{apiName:this.apiName,...i}),this.getUsageStatistics=i=>this.restService.request({method:"GET",url:"/api/saas/editions/statistics/usage-statistic"},{apiName:this.apiName,...i}),this.moveAllTenants=(i,a,s)=>this.restService.request({method:"PUT",url:`/api/saas/editions/${i}/move-all-tenants`,params:{editionId:a}},{apiName:this.apiName,...s}),this.update=(i,a,s)=>this.restService.request({method:"PUT",url:`/api/saas/editions/${i}`,body:a},{apiName:this.apiName,...s})}static{this.\u0275fac=function(i){return new(i||n)(e.KVO(l.G9T))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),R=(()=>{class n{constructor(t){this.restService=t,this.apiName="SaasHost",this.applyDatabaseMigrations=(i,a)=>this.restService.request({method:"POST",url:`/api/saas/tenants/${i}/apply-database-migrations`},{apiName:this.apiName,...a}),this.checkConnectionString=(i,a)=>this.restService.request({method:"GET",url:"/api/saas/tenants/check-connection-string",params:{connectionString:i}},{apiName:this.apiName,...a}),this.create=(i,a)=>this.restService.request({method:"POST",url:"/api/saas/tenants",body:i},{apiName:this.apiName,...a}),this.delete=(i,a)=>this.restService.request({method:"DELETE",url:`/api/saas/tenants/${i}`},{apiName:this.apiName,...a}),this.get=(i,a)=>this.restService.request({method:"GET",url:`/api/saas/tenants/${i}`},{apiName:this.apiName,...a}),this.getConnectionStrings=(i,a)=>this.restService.request({method:"GET",url:`/api/saas/tenants/${i}/connection-strings`},{apiName:this.apiName,...a}),this.getDatabases=i=>this.restService.request({method:"GET",url:"/api/saas/tenants/databases"},{apiName:this.apiName,...i}),this.getEditionLookup=i=>this.restService.request({method:"GET",url:"/api/saas/tenants/lookup/editions"},{apiName:this.apiName,...i}),this.getList=(i,a)=>this.restService.request({method:"GET",url:"/api/saas/tenants",params:{filter:i.filter,getEditionNames:i.getEditionNames,editionId:i.editionId,expirationDateMin:i.expirationDateMin,expirationDateMax:i.expirationDateMax,activationState:i.activationState,sorting:i.sorting,skipCount:i.skipCount,maxResultCount:i.maxResultCount}},{apiName:this.apiName,...a}),this.setPassword=(i,a,s)=>this.restService.request({method:"PUT",url:`/api/saas/tenants/${i}/set-password`,body:a},{apiName:this.apiName,...s}),this.update=(i,a,s)=>this.restService.request({method:"PUT",url:`/api/saas/tenants/${i}`,body:a},{apiName:this.apiName,...s}),this.updateConnectionStrings=(i,a,s)=>this.restService.request({method:"PUT",url:`/api/saas/tenants/${i}/connection-strings`,body:a},{apiName:this.apiName,...s})}static{this.\u0275fac=function(i){return new(i||n)(e.KVO(l.G9T))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var P=function(n){return n[n.Waiting=0]="Waiting",n[n.Completed=1]="Completed",n[n.Failed=2]="Failed",n[n.Refunded=3]="Refunded",n}(P||{});(0,l.l_2)(P);var $=function(n){return n[n.OneTime=0]="OneTime",n[n.Subscription=1]="Subscription",n}($||{});(0,l.l_2)($);var h=function(n){return n[n.Active=0]="Active",n[n.ActiveWithLimitedTime=1]="ActiveWithLimitedTime",n[n.Passive=2]="Passive",n}(h||{});const Me=(0,l.l_2)(h);var F=u(70980),De=u(5964),y=u(88141),w=u(54843),te=u(84412),E=u(7673),I=u(96354),r=u(89417),ne=u(89079),_=u(24721),c=u(15923),M=u(21998),g=u(30946),D=u(79066),b=u(15306),Ae=u(54741),A=u(47516),ie=u(58780);const je=n=>({"border-danger":n});function ke(n,o){1&n&&(e.j41(0,"h5",4),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s()),2&n&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"AbpUi::AreYouSure")," "))}function xe(n,o){if(1&n&&(e.j41(0,"option",16),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.displayName," ")}}function Oe(n,o){if(1&n&&(e.j41(0,"select",13)(1,"option",15),e.EFF(2),e.nI1(3,"abpLocalization"),e.k0s(),e.Z7z(4,xe,2,2,"option",16,e.Vm6),e.k0s()),2&n){const t=e.XpG(4);e.Y8G("ngClass",e.eq3(5,je,t.showAssignErrorMessage())),e.R7$(),e.Y8G("ngValue",null),e.R7$(),e.SpI(" ",e.bMT(3,3,t.loading()?"AbpUi::LoadingWithThreeDot":"Saas::SelectAnEditionToAssign")," "),e.R7$(2),e.Dyx(t.editions())}}function Ve(n,o){1&n&&(e.j41(0,"span",14),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s()),2&n&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"AbpValidation::ThisFieldIsRequired.")," "))}function Ge(n,o){if(1&n&&(e.j41(0,"div",8),e.nrm(1,"input",11),e.j41(2,"label",12),e.EFF(3),e.nI1(4,"abpLocalization"),e.k0s()(),e.DNE(5,Oe,6,7,"select",13),e.nI1(6,"async"),e.DNE(7,Ve,3,3,"span",14)),2&n){const t=e.XpG(3);e.R7$(),e.Y8G("value",!0),e.R7$(2),e.JRh(e.bMT(4,4,"Saas::AssignTenantsToOtherEdition")),e.R7$(2),e.vxM(e.bMT(6,6,t.assignType$)?5:-1),e.R7$(2),e.vxM(t.showAssignErrorMessage()?7:-1)}}function Le(n,o){if(1&n&&(e.j41(0,"p",7),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s(),e.j41(3,"div",8),e.nrm(4,"input",9),e.j41(5,"label",10),e.EFF(6),e.nI1(7,"abpLocalization"),e.k0s()(),e.DNE(8,Ge,8,8)),2&n){const t=e.XpG(2);e.R7$(),e.SpI(" ",e.i5U(2,4,"Saas::ChooseAnAction",t.tenantCount)," "),e.R7$(3),e.Y8G("value",!1),e.R7$(2),e.JRh(e.bMT(7,7,"Saas::UnassignTheEditionFromTheTenants")),e.R7$(2),e.vxM(t.editions().length>0?8:-1)}}function Pe(n,o){if(1&n){const t=e.RV6();e.j41(0,"p",5),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s(),e.j41(3,"form",6),e.bIt("ngSubmit",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.save())}),e.DNE(4,Le,9,9),e.k0s()}if(2&n){const t=e.XpG();e.R7$(),e.SpI(" ",e.i5U(2,3,"Saas::EditionDeletionConfirmationMessage",t.name)," "),e.R7$(2),e.Y8G("formGroup",t.form),e.R7$(),e.vxM(t.tenantCount>0?4:-1)}}function $e(n,o){if(1&n&&(e.j41(0,"button",17),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s(),e.j41(3,"button",18),e.nrm(4,"i",19),e.EFF(5),e.nI1(6,"abpLocalization"),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.SpI(" ",e.bMT(2,3,"AbpUi::Cancel")," "),e.R7$(2),e.Y8G("loading",t.loading()),e.R7$(2),e.SpI(" ",e.bMT(6,5,"AbpUi::Delete")," ")}}function we(n,o){1&n&&(e.j41(0,"h5",4),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s()),2&n&&(e.R7$(),e.SpI(" ",e.bMT(2,1,"Saas::MoveAllTenants")," "))}function Ue(n,o){if(1&n&&(e.j41(0,"option",9),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("value",t.id),e.R7$(),e.JRh(t.displayName)}}function Be(n,o){if(1&n){const t=e.RV6();e.nrm(0,"p",5),e.nI1(1,"abpLocalization"),e.j41(2,"form",6),e.bIt("ngSubmit",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.save())}),e.j41(3,"select",7)(4,"option",8),e.EFF(5),e.nI1(6,"abpLocalization"),e.k0s(),e.Z7z(7,Ue,2,2,"option",9,e.Vm6),e.k0s()()}if(2&n){const t=e.XpG();e.Y8G("innerHTML",e.i5U(1,3,"Saas::MoveAllTenantsWithEditionTo",t.name),e.npT),e.R7$(2),e.Y8G("formGroup",t.form),e.R7$(3),e.SpI(" ",e.bMT(6,6,t.loading()?"AbpUi::LoadingWithThreeDot":"Saas::UnassignEdition")," "),e.R7$(2),e.Dyx(t.editions())}}function Xe(n,o){if(1&n&&(e.j41(0,"button",10),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s(),e.j41(3,"button",11),e.nrm(4,"i",12),e.EFF(5),e.nI1(6,"abpLocalization"),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.SpI(" ",e.bMT(2,4,"AbpUi::Cancel")," "),e.R7$(2),e.Y8G("loading",t.loading())("disabled",t.form.invalid&&t.form.touched),e.R7$(2),e.SpI(" ",e.bMT(6,6,"AbpUi::Save")," ")}}const ze=()=>({value:"E"}),U=n=>({value:n}),ae=n=>({value:n,twoWay:!0}),oe=(n,o,t)=>({providerName:n,providerKey:o,visible:t}),se=n=>({visibleChange:n}),re=(n,o)=>({inputs:n,outputs:o,componentKey:"FeatureManagement.FeatureManagementComponent"});function Ye(n,o){if(1&n&&(e.j41(0,"h3"),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,null!=t.selected&&t.selected.id?"Saas::Edit":"Saas::NewEdition"))}}function We(n,o){if(1&n){const t=e.RV6();e.j41(0,"form",12),e.bIt("ngSubmit",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.save())}),e.j41(1,"div",13),e.nrm(2,"abp-extensible-form",14),e.k0s()()}if(2&n){const t=e.XpG(2);e.Y8G("formGroup",t.editionForm),e.R7$(2),e.Y8G("selectedRecord",t.selected)}}function Qe(n,o){if(1&n&&e.DNE(0,We,3,2,"form",11),2&n){const t=e.XpG();e.vxM(t.editionForm?0:-1)}}function Je(n,o){1&n&&(e.j41(0,"button",15),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s(),e.j41(3,"abp-button",16),e.EFF(4),e.nI1(5,"abpLocalization"),e.k0s()),2&n&&(e.R7$(),e.SpI(" ",e.bMT(2,2,"Saas::Cancel")," "),e.R7$(3),e.JRh(e.bMT(5,4,"AbpIdentity::Save")))}function He(n,o){if(1&n){const t=e.RV6();e.j41(0,"abp-feature-management",17),e.mxI("visibleChange",function(a){e.eBV(t);const s=e.XpG();return e.DH7(s.visibleFeatures,a)||(s.visibleFeatures=a),e.Njj(a)}),e.k0s()}if(2&n){const t=e.XpG();e.R50("visible",t.visibleFeatures),e.Y8G("providerKey",t.providerKey)}}function Ke(n,o){if(1&n){const t=e.RV6();e.j41(0,"abp-edition-delete",18),e.bIt("visibleChange",function(a){e.eBV(t);const s=e.XpG();return e.Njj(s.onVisibleDeleteChange(a))}),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("visible",t.visibleEditionDelete)("selected",t.selected)}}function qe(n,o){if(1&n){const t=e.RV6();e.j41(0,"abp-move-all-tenants",18),e.bIt("visibleChange",function(a){e.eBV(t);const s=e.XpG();return e.Njj(s.onVisibleMoveChange(a))}),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("visible",t.visibleMove)("selected",t.selected)}}const Ze=(n,o)=>o.id;function et(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",9)(1,"div",10)(2,"label",11),e.EFF(3),e.nI1(4,"abpLocalization"),e.k0s(),e.nrm(5,"input",12),e.k0s(),e.j41(6,"div",13)(7,"button",14),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.checkConnectionString())}),e.EFF(8),e.nI1(9,"abpLocalization"),e.k0s()()()}2&n&&(e.R7$(3),e.JRh(e.bMT(4,2,"Saas::DisplayName:Default")),e.R7$(5),e.SpI(" ",e.bMT(9,4,"Saas::CheckConnectionString")," "))}function tt(n,o){if(1&n&&(e.j41(0,"option",28),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.Y8G("ngValue",t),e.R7$(),e.SpI(" ",t.databaseName," ")}}function nt(n,o){1&n&&e.DNE(0,tt,2,2,"option",28),2&n&&e.vxM(o.$implicit.connectionString?-1:0)}function it(n,o){if(1&n){const t=e.RV6();e.j41(0,"strong"),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s(),e.nrm(3,"hr"),e.j41(4,"div",31)(5,"button",32),e.bIt("click",function(){e.eBV(t),e.XpG();const a=e.sdS(9);return e.Njj(a.close())}),e.EFF(6),e.nI1(7,"abpLocalization"),e.k0s(),e.j41(8,"button",33),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2).$index,s=e.XpG(4);return e.Njj(s.removeDbConnectionString(a))}),e.EFF(9),e.nI1(10,"abpLocalization"),e.k0s()()}2&n&&(e.R7$(),e.JRh(e.bMT(2,3,"AbpUi::AreYouSure")),e.R7$(5),e.SpI(" ",e.bMT(7,5,"AbpUi::Cancel")," "),e.R7$(3),e.SpI(" ",e.bMT(10,7,"AbpUi::Yes")," "))}function at(n,o){if(1&n&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.DNE(6,it,11,9,"ng-template",null,0,e.C5r),e.j41(8,"button",29,1),e.nrm(10,"i",30),e.k0s()()()),2&n){const t=e.sdS(7),i=e.XpG().$implicit;e.R7$(2),e.JRh(i.databaseName),e.R7$(2),e.JRh(i.connectionString),e.R7$(4),e.Y8G("ngbPopover",t)}}function ot(n,o){1&n&&e.DNE(0,at,11,3,"tr"),2&n&&e.vxM(o.$implicit.connectionString?0:-1)}function st(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",18)(1,"div",19)(2,"div")(3,"label",20),e.EFF(4),e.nI1(5,"abpLocalization"),e.k0s(),e.j41(6,"select",21),e.mxI("ngModelChange",function(a){e.eBV(t);const s=e.XpG(3);return e.DH7(s.selectedDatabase,a)||(s.selectedDatabase=a),e.Njj(a)}),e.Z7z(7,nt,1,1,null,null,e.Vm6),e.k0s()()(),e.j41(9,"div",22)(10,"div")(11,"label",23),e.EFF(12),e.nI1(13,"abpLocalization"),e.k0s(),e.j41(14,"input",24),e.mxI("ngModelChange",function(a){e.eBV(t);const s=e.XpG(3);return e.DH7(s.databaseConnectionString,a)||(s.databaseConnectionString=a),e.Njj(a)}),e.bIt("keyup.enter",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.addDatabaseConnectionString())}),e.k0s()()(),e.j41(15,"div",19)(16,"button",25),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.addDatabaseConnectionString())}),e.EFF(17),e.nI1(18,"abpLocalization"),e.k0s(),e.j41(19,"button",14),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.checkConnectionString(a.databaseConnectionString))}),e.EFF(20),e.nI1(21,"abpLocalization"),e.k0s()()(),e.j41(22,"div",26)(23,"table",27)(24,"thead")(25,"tr")(26,"th"),e.EFF(27),e.nI1(28,"abpLocalization"),e.k0s(),e.j41(29,"th"),e.EFF(30),e.nI1(31,"abpLocalization"),e.k0s(),e.j41(32,"th"),e.EFF(33),e.nI1(34,"abpLocalization"),e.k0s()()(),e.j41(35,"tbody"),e.Z7z(36,ot,1,1,null,null,Ze),e.k0s()()()}if(2&n){const t=e.XpG(3);e.R7$(4),e.JRh(e.bMT(5,9,"Saas::DisplayName:DatabaseName")),e.R7$(2),e.R50("ngModel",t.selectedDatabase),e.R7$(),e.Dyx(t.databases),e.R7$(5),e.JRh(e.bMT(13,11,"Saas::DisplayName:ConnectionString")),e.R7$(2),e.R50("ngModel",t.databaseConnectionString),e.R7$(3),e.SpI(" ",e.bMT(18,13,"Saas::AddDatabaseConnectionString")," "),e.R7$(3),e.SpI(" ",e.bMT(21,15,"Saas::CheckConnectionString")," "),e.R7$(7),e.JRh(e.bMT(28,17,"Saas::DisplayName:DatabaseName")),e.R7$(3),e.JRh(e.bMT(31,19,"Saas::DisplayName:ConnectionString")),e.R7$(3),e.JRh(e.bMT(34,21,"Saas::Actions")),e.R7$(3),e.Dyx(t.databases)}}function rt(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",15)(1,"input",16),e.mxI("ngModelChange",function(a){e.eBV(t);const s=e.XpG(2);return e.DH7(s.moduleSpecificDatabase,a)||(s.moduleSpecificDatabase=a),e.Njj(a)}),e.k0s(),e.j41(2,"label",17),e.EFF(3),e.nI1(4,"abpLocalization"),e.k0s()(),e.DNE(5,st,38,23)}if(2&n){const t=e.XpG(2);e.R7$(),e.R50("ngModel",t.moduleSpecificDatabase),e.R7$(2),e.SpI(" ",e.bMT(4,3,"Saas::DisplayName:UseSpecificDatabase")," "),e.R7$(2),e.vxM(null!=t.databases&&t.databases.length&&t.moduleSpecificDatabase?5:-1)}}function lt(n,o){if(1&n){const t=e.RV6();e.j41(0,"form",4)(1,"div",5)(2,"div",6)(3,"input",7),e.bIt("ngModelChange",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.onSharedDatabaseChange())}),e.k0s(),e.j41(4,"label",8),e.EFF(5),e.nI1(6,"abpLocalization"),e.k0s()()(),e.DNE(7,et,10,6,"div",9),e.k0s(),e.DNE(8,rt,6,5)}if(2&n){const t=e.XpG();e.Y8G("formGroup",t.form),e.R7$(5),e.JRh(e.bMT(6,4,"Saas::DisplayName:UseSharedDatabase")),e.R7$(2),e.vxM(t.form.get("useSharedDatabase").value?-1:7),e.R7$(),e.vxM(!t.form.get("useSharedDatabase").value&&null!=t.databases&&t.databases.length?8:-1)}}function ct(n,o){1&n&&(e.j41(0,"div",3),e.nrm(1,"i",34),e.k0s())}const dt=()=>({size:"md"});function pt(n,o){if(1&n&&(e.j41(0,"h5"),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Lme("",e.bMT(2,2,"AbpIdentity::SetPassword")," - ",t.tenantName,"")}}function mt(n,o){if(1&n){const t=e.RV6();e.j41(0,"form",6,3),e.bIt("ngSubmit",function(){e.eBV(t);const a=e.sdS(1),s=e.XpG(2);return e.Njj(s.save(a))}),e.j41(2,"div",7)(3,"label",8),e.EFF(4),e.nI1(5,"abpLocalization"),e.k0s(),e.nrm(6,"input",9),e.nI1(7,"abpLocalization"),e.k0s(),e.j41(8,"div",7)(9,"label",10),e.EFF(10),e.nI1(11,"abpLocalization"),e.k0s(),e.j41(12,"div",11),e.nrm(13,"input",12),e.j41(14,"button",13),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.fieldTextType=!a.fieldTextType)}),e.nrm(15,"i"),e.k0s(),e.j41(16,"button",14),e.nI1(17,"abpLocalization"),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.generatePassword())}),e.nrm(18,"i",15),e.k0s()()()()}if(2&n){const t=e.XpG(2);e.Y8G("formGroup",t.form)("markAsDirtyWhenSubmit",!1),e.R7$(4),e.JRh(e.bMT(5,10,"Saas::UserName")),e.R7$(2),e.FS9("ngbTooltip",e.bMT(7,12,"Saas::UserNameTooltip")),e.R7$(4),e.JRh(e.bMT(11,14,"Saas::Password")),e.R7$(3),e.Y8G("type",t.fieldTextType?"text":"password"),e.R7$(2),e.ZvI("fa fa-eye",t.fieldTextType?"":"-slash",""),e.R7$(),e.FS9("ngbTooltip",e.bMT(17,16,"AbpIdentity::GenerateRandomPasswordTooltip"))}}function ut(n,o){if(1&n&&e.DNE(0,mt,19,18,"form",5),2&n){const t=e.XpG();e.vxM(t.form?0:-1)}}function _t(n,o){1&n&&(e.j41(0,"button",16),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s(),e.j41(3,"abp-button",17),e.EFF(4),e.nI1(5,"abpLocalization"),e.k0s()),2&n&&(e.R7$(),e.SpI(" ",e.bMT(2,2,"Saas::Cancel")," "),e.R7$(3),e.JRh(e.bMT(5,4,"Saas::Save")))}function bt(n,o){1&n&&(e.j41(0,"h3"),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s()),2&n&&(e.R7$(),e.JRh(e.bMT(2,1,"Saas::LoginWithThisTenant")))}function ht(n,o){if(1&n){const t=e.RV6();e.j41(0,"form",5),e.bIt("ngSubmit",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.save())}),e.j41(1,"div",6)(2,"label",7),e.EFF(3),e.nI1(4,"abpLocalization"),e.k0s(),e.nrm(5,"input",8),e.k0s()()}if(2&n){const t=e.XpG(2);e.Y8G("formGroup",t.form),e.R7$(3),e.SpI(" ",e.bMT(4,2,"Saas::UserName")," ")}}function gt(n,o){if(1&n&&e.DNE(0,ht,6,4,"form",4),2&n){const t=e.XpG();e.vxM(t.form?0:-1)}}function ft(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",9),e.bIt("click",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.visibleChange(!1))}),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s(),e.j41(3,"button",10),e.EFF(4),e.nI1(5,"abpLocalization"),e.k0s()}2&n&&(e.R7$(),e.SpI(" ",e.bMT(2,2,"Saas::Cancel")," "),e.R7$(3),e.SpI(" ",e.bMT(5,4,"Saas::Login")," "))}const Tt=["tenantModalTemplate"],St=["connectionStringModalTemplate"],vt=()=>({size:"lg"}),Ct=()=>({value:"T"}),le=n=>({formSubmit:n}),Et=(n,o)=>({outputs:n,componentKey:o}),Ft=n=>({selectedTenant:n}),yt=(n,o,t)=>({inputs:n,outputs:o,componentKey:t});function Nt(n,o){if(1&n&&(e.j41(0,"option",24),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s()),2&n){const t=o.$implicit;e.Y8G("ngValue",t.key),e.R7$(),e.SpI(" ",e.bMT(2,2,"Saas::Enum:TenantActivationState."+t.key)," ")}}function It(n,o){if(1&n&&(e.j41(0,"h3"),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.JRh(e.bMT(2,1,t.selectedModalContent.title))}}function Rt(n,o){1&n&&e.eu8(0)}function Mt(n,o){if(1&n&&e.DNE(0,Rt,1,0,"ng-container",34),2&n){const t=e.XpG();e.Y8G("ngTemplateOutlet",null==t.selectedModalContent?null:t.selectedModalContent.template)}}function Dt(n,o){1&n&&(e.j41(0,"abp-button",36),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s()),2&n&&(e.R7$(),e.SpI("",e.bMT(2,1,"AbpUi::Save")," "))}function At(n,o){if(1&n){const t=e.RV6();e.j41(0,"abp-button",38),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.save())}),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s()}if(2&n){const t=e.XpG(2);e.Y8G("disabled",t.isDisabledSaveButton),e.R7$(),e.SpI("",e.bMT(2,2,"AbpUi::Save")," ")}}function jt(n,o){if(1&n&&(e.j41(0,"button",35),e.EFF(1),e.nI1(2,"abpLocalization"),e.k0s(),e.DNE(3,Dt,3,3,"abp-button",36)(4,At,3,4,"abp-button",37)),2&n){let t;const i=e.XpG();e.R7$(),e.SpI(" ",e.bMT(2,2,"Saas::Cancel")," "),e.R7$(2),e.vxM("saveTenant"===(t=null==i.selectedModalContent?null:i.selectedModalContent.type)?3:"saveConnStr"===t?4:-1)}}function kt(n,o){if(1&n){const t=e.RV6();e.j41(0,"abp-set-tenant-password-modal",40),e.bIt("modalVisibleChange",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.closeSetTenantPasswordModal())}),e.k0s()}if(2&n){const t=e.XpG(2);e.Y8G("modalVisible",t.isVisibleSetTenantPasswordModal)("tenantId",t.selectedTenantId)("tenantName",t.selectedTenantNameForSetTenantPasswordModal)}}function xt(n,o){if(1&n&&e.DNE(0,kt,1,3,"abp-set-tenant-password-modal",39),2&n){const t=e.XpG();e.Y8G("abpReplaceableTemplate",t.setTenantReplaceableTemplateOptions)}}function Ot(n,o){1&n&&e.eu8(0)}function Vt(n,o){1&n&&e.eu8(0)}function Gt(n,o){if(1&n&&e.DNE(0,Vt,1,0,"ng-container",34),2&n){e.XpG(2);const t=e.sdS(4);e.Y8G("ngTemplateOutlet",t)}}function Lt(n,o){1&n&&e.eu8(0)}function Pt(n,o){if(1&n&&e.DNE(0,Lt,1,0,"ng-container",34),2&n){e.XpG(2);const t=e.sdS(6);e.Y8G("ngTemplateOutlet",t)}}function $t(n,o){if(1&n&&(e.j41(0,"ul",41,9)(2,"li",42)(3,"a",43),e.EFF(4),e.nI1(5,"abpLocalization"),e.k0s(),e.DNE(6,Gt,1,1,"ng-template",44),e.k0s(),e.j41(7,"li",42)(8,"a",43),e.EFF(9),e.nI1(10,"abpLocalization"),e.k0s(),e.DNE(11,Pt,1,1,"ng-template",44),e.k0s()(),e.nrm(12,"div",45)),2&n){const t=e.sdS(1);e.Y8G("destroyOnHide",!1),e.R7$(4),e.JRh(e.bMT(5,4,"Saas::TenantBaseInfo")),e.R7$(5),e.JRh(e.bMT(10,6,"Saas::ConnectionStrings")),e.R7$(3),e.Y8G("ngbNavOutlet",t)}}function wt(n,o){if(1&n){const t=e.RV6();e.j41(0,"form",47),e.bIt("ngSubmit",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.save())}),e.nrm(1,"abp-extensible-form",48),e.k0s()}if(2&n){const t=e.XpG(3);e.Y8G("formGroup",t.tenantForm),e.R7$(),e.Y8G("selectedRecord",t.selected)}}function Ut(n,o){if(1&n&&e.DNE(0,wt,2,2,"form",46),2&n){const t=e.XpG(2);e.vxM(t.tenantForm?0:-1)}}function Bt(n,o){if(1&n){const t=e.RV6();e.j41(0,"abp-connection-strings",50),e.bIt("formSubmit",function(){e.eBV(t);const a=e.XpG(3);return e.Njj(a.save())}),e.k0s()}}function Xt(n,o){if(1&n&&e.DNE(0,Bt,1,0,"abp-connection-strings",49),2&n){const t=e.XpG(2);e.Y8G("abpReplaceableTemplate",e.l_i(3,Et,e.eq3(1,le,t.save),t.connectionStringsReplacementKey))}}function zt(n,o){if(1&n&&e.DNE(0,Ot,1,0,"ng-container",34)(1,$t,13,8,"ng-template",null,6,e.C5r)(3,Ut,1,1,"ng-template",null,7,e.C5r)(5,Xt,1,6,"ng-template",null,8,e.C5r),2&n){const t=e.sdS(2),i=e.sdS(4),a=e.XpG();e.Y8G("ngTemplateOutlet",null!=a.selected&&a.selected.id?i:t)}}function Yt(n,o){if(1&n){const t=e.RV6();e.j41(0,"abp-connection-strings",52),e.bIt("formSubmit",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.save())}),e.k0s()}if(2&n){const t=e.XpG(2);e.Y8G("selectedTenant",t.selected)}}function Wt(n,o){if(1&n&&e.DNE(0,Yt,1,1,"abp-connection-strings",51),2&n){const t=e.XpG();e.Y8G("abpReplaceableTemplate",e.sMw(7,yt,e.eq3(3,Ft,e.eq3(1,U,t.selected)),e.eq3(5,le,t.save),t.connectionStringsReplacementKey))}}function Qt(n,o){if(1&n){const t=e.RV6();e.j41(0,"abp-feature-management",53),e.mxI("visibleChange",function(a){e.eBV(t);const s=e.XpG();return e.DH7(s.visibleFeatures,a)||(s.visibleFeatures=a),e.Njj(a)}),e.k0s()}if(2&n){const t=e.XpG();e.R50("visible",t.visibleFeatures),e.Y8G("providerKey",t.providerKey)}}function Jt(n,o){if(1&n&&(e.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"h5",5),e.EFF(4),e.nI1(5,"abpLocalization"),e.k0s()(),e.j41(6,"div",6)(7,"div",7),e.nrm(8,"abp-chart",8,0),e.k0s()()()()),2&n){const t=e.XpG();e.R7$(4),e.JRh(e.bMT(5,4,"Saas::EditionUsageStatistics")),e.R7$(4),e.Y8G("data",t.chartData)("width",t.width)("height",t.height)}}function Ht(n,o){if(1&n&&(e.j41(0,"tr")(1,"th"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&n){const t=o.$implicit,i=o.$index;e.R7$(2),e.JRh(i+1),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.editionName)}}function Kt(n,o){if(1&n&&(e.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"h5",4),e.EFF(4),e.nI1(5,"abpLocalization"),e.k0s()(),e.j41(6,"div",5)(7,"div")(8,"table",6)(9,"thead")(10,"tr")(11,"th"),e.EFF(12,"#"),e.k0s(),e.j41(13,"th"),e.EFF(14),e.nI1(15,"abpLocalization"),e.k0s(),e.j41(16,"th"),e.EFF(17),e.nI1(18,"abpLocalization"),e.k0s()()(),e.j41(19,"tbody"),e.Z7z(20,Ht,7,3,"tr",null,e.Vm6),e.k0s()()()()()()),2&n){const t=e.XpG();e.R7$(4),e.JRh(e.bMT(5,5,"Saas::LatestTenants")),e.R7$(3),e.xc7("min-height",t.minHeight,"px"),e.R7$(7),e.JRh(e.bMT(15,7,"Saas::Name")),e.R7$(3),e.JRh(e.bMT(18,9,"Saas::EditionName")),e.R7$(3),e.Dyx(t.data)}}function ce(){return n=>{const o=n.get("assignType")?.value,t=n.get("edition")?.value;return!o||o&&t?null:{edition:{required:!0}}}}let de=(()=>{class n{constructor(){this.visibleChange=new e.bkB,this.#e=(0,e.vPA)(!1),this.loading=(0,e.vPA)(!1),this.#t=(0,e.vPA)([]),this.editions=(0,e.EWP)(()=>this.#t().filter(t=>!this.selected||t.id!==this.selected?.id)),this.trackByService=(0,e.WQX)(l.kTg),this.trackByFn=this.trackByService.by("id"),this.editionService=(0,e.WQX)(N),this.fb=(0,e.WQX)(r.ok),this.destroyRef=(0,e.WQX)(e.abz),this.toasterService=(0,e.WQX)(d.W9),this.form=this.fb.group({assignType:[!1],edition:[null]},{validators:n=>{const o=n.get("assignType")?.value,t=n.get("edition")?.value;return!o||o&&t?null:{edition:{required:!0}}}})}#e;#t;get tenantCount(){return this.selected?.tenantCount||0}get name(){return this.selected?.displayName||""}get assignType$(){return this.form.controls.assignType.valueChanges}get assignType(){return this.form.controls.assignType}get edition(){return this.form.controls.edition}onVisibleChange(t){this.visibleChange.emit({visible:t,refresh:!1})}ngOnInit(){this.loading.set(!0),this.editionService.getAllList().pipe((0,F.j)(()=>this.loading.set(!1))).subscribe(t=>this.#t.set(t)),this.assignType$.pipe((0,De.p)(t=>!t),(0,y.M)(()=>this.#e.set(!1)),(0,ne.pQ)(this.destroyRef)).subscribe()}showAssignErrorMessage(){return this.assignType.value&&!this.edition.value&&this.form.errors.edition.required&&this.#e()}save(){var t=this;return(0,ee.A)(function*(){if(t.#e.set(!0),t.form.invalid)return;t.loading.set(!0);const{assignType:i,edition:a}=t.form.value;if(i){const m=t.editionService.moveAllTenants(t.selected.id,a);yield(0,w._)(m)}const s=t.editionService.delete(t.selected.id);yield(0,w._)(s),t.loading.set(!1),t.toasterService.success("AbpUi::DeletedSuccessfully"),t.visibleChange.emit({visible:!1,refresh:!0})})()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["abp-edition-delete"]],inputs:{visible:"visible",selected:"selected"},outputs:{visibleChange:"visibleChange"},standalone:!0,features:[e.aNF],decls:7,vars:2,consts:[["abpHeader",""],["abpBody",""],["abpFooter",""],[3,"visibleChange","visible","suppressUnsavedChangesWarning"],[1,"modal-title"],[1,"fw-bold"],["id","edition-delete-form",3,"ngSubmit","formGroup"],[1,"mt-2"],[1,"form-check","mt-2"],["formControlName","assignType","type","radio","name","assignType","id","unassign",1,"form-check-input",3,"value"],["for","unassign",1,"form-check-label"],["formControlName","assignType","type","radio","name","assignType","id","assign",1,"form-check-input",3,"value"],["for","assign",1,"form-check-label"],["formControlName","edition",1,"form-select","mt-2",3,"ngClass"],[1,"text-danger"],["selected","",3,"ngValue"],[3,"value"],["abpClose","","type","button",1,"btn","btn-outline-danger"],["type","submit","form","edition-delete-form",1,"btn","btn-danger",3,"loading"],["aria-hidden","true",1,"fa","fa-trash"]],template:function(i,a){if(1&i){const s=e.RV6();e.j41(0,"abp-modal",3),e.bIt("visibleChange",function(p){return e.eBV(s),e.Njj(a.onVisibleChange(p))}),e.DNE(1,ke,3,3,"ng-template",null,0,e.C5r)(3,Pe,5,6,"ng-template",null,1,e.C5r)(5,$e,7,7,"ng-template",null,2,e.C5r),e.k0s()}2&i&&e.Y8G("visible",a.visible)("suppressUnsavedChangesWarning",!0)},dependencies:[C.MD,C.YU,C.Jj,d.Ts,_.a5,_.lt,d.zf,d.b6,l.Ui,r.qT,r.xH,r.y7,r.me,r.wz,r.Fm,r.BC,r.cb,r.j4,r.JD,l.aM3,l.S02],encapsulation:2})}}return n})(),pe=(()=>{class n{constructor(){this.visibleChange=new e.bkB,this.loading=(0,e.vPA)(!1),this.#e=(0,e.vPA)([]),this.editions=(0,e.EWP)(()=>this.#e().filter(t=>!this.selected||t.id!==this.selected?.id)),this.trackByService=(0,e.WQX)(l.kTg),this.trackByFn=this.trackByService.by("id"),this.editionService=(0,e.WQX)(N),this.fb=(0,e.WQX)(r.ok),this.toasterService=(0,e.WQX)(d.W9),this.form=this.fb.group({edition:[""]})}#e;get name(){return this.selected?.displayName||""}onVisibleChange(t){this.visibleChange.emit({visible:t,refresh:!1})}ngOnInit(){this.loading.set(!0),this.editionService.getAllList().pipe((0,F.j)(()=>this.loading.set(!1))).subscribe(t=>this.#e.set(t))}save(){var t=this;return(0,ee.A)(function*(){if(t.form.invalid)return;t.loading.set(!0);const{edition:i}=t.form.value,a=t.editionService.moveAllTenants(t.selected.id,i);yield(0,w._)(a),t.loading.set(!1),t.toasterService.success("AbpUi::SavedSuccessfully"),t.visibleChange.emit({visible:!1,refresh:!0})})()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["abp-move-all-tenants"]],inputs:{visible:"visible",selected:"selected"},outputs:{visibleChange:"visibleChange"},standalone:!0,features:[e.aNF],decls:7,vars:2,consts:[["abpHeader",""],["abpBody",""],["abpFooter",""],[3,"visibleChange","visible","suppressUnsavedChangesWarning"],[1,"modal-title"],[3,"innerHTML"],["id","edition-move-tenants-form",3,"ngSubmit","formGroup"],["formControlName","edition",1,"form-select","mt-2"],["value","","selected",""],[3,"value"],["abpClose","","type","button",1,"btn","btn-outline-primary"],["type","submit","form","edition-move-tenants-form",1,"btn","btn-primary",3,"loading","disabled"],["aria-hidden","true",1,"fa","fa-check","me-1"]],template:function(i,a){if(1&i){const s=e.RV6();e.j41(0,"abp-modal",3),e.bIt("visibleChange",function(p){return e.eBV(s),e.Njj(a.onVisibleChange(p))}),e.DNE(1,we,3,3,"ng-template",null,0,e.C5r)(3,Be,9,8,"ng-template",null,1,e.C5r)(5,Xe,7,8,"ng-template",null,2,e.C5r),e.k0s()}2&i&&e.Y8G("visible",a.visible)("suppressUnsavedChangesWarning",!0)},dependencies:[C.MD,d.Ts,_.a5,_.lt,d.zf,d.b6,l.Ui,r.qT,r.xH,r.y7,r.wz,r.BC,r.cb,r.j4,r.JD,l.aM3,l.S02],encapsulation:2})}}return n})(),S=(()=>{class n{constructor(t,i,a,s,m){this.list=t,this.service=i,this.injector=a,this.confirmationService=s,this.destroyRef=m,this.data={items:[],totalCount:0},this.plans$=new te.t([]),this.visibleMove=!1,this.isModalVisible=!1,this.visibleEditionDelete=!1,this.visibleFeatures=!1,this.modalBusy=!1,this.onVisibleFeaturesChange=p=>{this.visibleFeatures=p},this.toasterService=(0,e.WQX)(d.W9)}ngOnInit(){this.hookToQuery()}hookToQuery(){this.list.hookToQuery(t=>this.service.getList(t)).subscribe(t=>this.data=t)}createEditionForm(){const t=new c.a9(this.injector,this.selected);this.editionForm=(0,c.uB)(t),this.getPlanLookup()}onAddEdition(){this.selected={},this.createEditionForm(),this.isModalVisible=!0}onEditEdition(t){this.service.get(t).subscribe(i=>{this.selected=i,this.createEditionForm(),this.isModalVisible=!0})}save(){if(!this.editionForm.valid)return;this.modalBusy=!0;const{id:t}=this.selected;(t?this.service.update(t,{...this.selected,...this.editionForm.value}):this.service.create(this.editionForm.value)).pipe((0,F.j)(()=>this.modalBusy=!1)).subscribe(()=>{this.list.get(),this.toasterService.success("AbpUi::SavedSuccessfully"),this.isModalVisible=!1})}openFeaturesModal(t){this.providerKey=t,setTimeout(()=>{this.visibleFeatures=!0},0)}getPlanLookup(){this.service.getPlanLookup().subscribe(t=>{this.plans$.next(t)})}delete(t){this.selected=t,this.visibleEditionDelete=!0}onVisibleDeleteChange(t){t.visible||(t.refresh&&this.list.get(),this.selected=null,this.visibleEditionDelete=!1)}moveAllTenants(t){0!==t.tenantCount?(this.selected=t,this.visibleMove=!0):this.confirmationService.warn("Saas::ThereIsNoTenantsCurrentlyInThisEdition","AbpUi::Warning",{hideCancelBtn:!0,yesText:"AbpUi::Ok"}).pipe((0,ne.pQ)(this.destroyRef)).subscribe()}onVisibleMoveChange(t){t.visible||(t.refresh&&this.list.get(),this.selected=null,this.visibleMove=!1)}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(l.aGM),e.rXU(N),e.rXU(e.zZn),e.rXU(d.td),e.rXU(e.abz))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["abp-editions"]],standalone:!0,features:[e.Jv_([l.aGM,{provide:c.JF,useValue:"Saas.EditionsComponent"}]),e.aNF],decls:16,vars:27,consts:[["abpHeader",""],["abpBody",""],["abpFooter",""],[3,"title","toolbar"],["id","wrapper"],["localizationSourceName","Saas",3,"list"],[1,"card"],[3,"data","recordsTotal","list"],[3,"visibleChange","disappear","visible","busy"],["providerName","E",3,"visible","providerKey","visibleChange",4,"abpReplaceableTemplate"],[3,"visible","selected"],["id","editionForm","validateOnSubmit","",3,"formGroup"],["id","editionForm","validateOnSubmit","",3,"ngSubmit","formGroup"],[1,"mt-2"],[3,"selectedRecord"],["abpClose","","type","button",1,"btn","btn-outline-primary"],["iconClass","fa fa-check","buttonType","submit","formName","editionForm"],["providerName","E",3,"visibleChange","visible","providerKey"],[3,"visibleChange","visible","selected"]],template:function(i,a){if(1&i){const s=e.RV6();e.j41(0,"abp-page",3),e.nI1(1,"abpLocalization"),e.j41(2,"div",4),e.nrm(3,"abp-advanced-entity-filters",5),e.j41(4,"div",6),e.nrm(5,"abp-extensible-table",7),e.k0s()()(),e.j41(6,"abp-modal",8),e.mxI("visibleChange",function(p){return e.eBV(s),e.DH7(a.isModalVisible,p)||(a.isModalVisible=p),e.Njj(p)}),e.bIt("disappear",function(){return e.eBV(s),e.Njj(a.createEditionForm())}),e.DNE(7,Ye,3,3,"ng-template",null,0,e.C5r)(9,Qe,1,1,"ng-template",null,1,e.C5r)(11,Je,6,6,"ng-template",null,2,e.C5r),e.k0s(),e.DNE(13,He,1,2,"abp-feature-management",9)(14,Ke,1,2,"abp-edition-delete",10)(15,qe,1,2,"abp-move-all-tenants",10)}2&i&&(e.Y8G("title",e.bMT(1,11,"Saas::Editions"))("toolbar",a.data.items),e.R7$(3),e.Y8G("list",a.list),e.R7$(2),e.Y8G("data",a.data.items)("recordsTotal",a.data.totalCount)("list",a.list),e.R7$(),e.R50("visible",a.isModalVisible),e.Y8G("busy",a.modalBusy),e.R7$(7),e.Y8G("abpReplaceableTemplate",e.l_i(24,re,e.sMw(18,oe,e.lJ4(13,ze),e.eq3(14,U,a.providerKey),e.eq3(16,ae,a.visibleFeatures)),e.eq3(22,se,a.onVisibleFeaturesChange))),e.R7$(),e.vxM(a.visibleEditionDelete?14:-1),e.R7$(),e.vxM(a.visibleMove?15:-1))},dependencies:[de,pe,_.fs,_.a5,M.wq,M.H1,d.Ts,d.Qp,d.zf,d.b6,g.Fl,g.Is,D.sQ,D.NO,c.U9,c.X3,c.XY,l.y98,l.ewT,l.aM3,r.X1,r.qT,r.cb,r.j4],encapsulation:2})}}return n})();function me([n,o]){return t=>{const i=t,a=i.get(n),s=i.get(o);return a&&s&&!a.value&&!s.value?{required:!0}:null}}const B=new e.nKC(void 0),ue={provide:B,multi:!0,useFactory:_e};function _e(){return o=>{const t=o?.get("activationState"),i=o?.get("activationEndDate");return!t||!i||t.value===h.ActiveWithLimitedTime&&!i.value&&i.setErrors({required:!0}),(0,E.of)(null)}}let j=(()=>{class n{constructor(){this.formSubmit=new e.bkB,this.service=(0,e.WQX)(R),this.fb=(0,e.WQX)(r.ze),this.toasterService=(0,e.WQX)(d.W9),this.form=this.fb.group({useSharedDatabase:[!0],defaultConnectionString:[null]},{validators:[me(["useSharedDatabase","defaultConnectionString"])]}),this.moduleSpecificDatabase=!1}get useSharedDatabase(){return this.form.get("useSharedDatabase")}get defaultConnectionString(){return this.form.get("defaultConnectionString")}ngOnInit(){this.getInitialData()}getInitialData(){this.loading=!0,(this.selectedTenant?this.getConnectionStrings():this.getDatabases()).pipe((0,F.j)(()=>this.loading=!1)).subscribe()}selectFirstDatabase(){this.selectedDatabase=this.databases?.find(t=>!t.connectionString)}getDatabases(){return this.service.getDatabases().pipe((0,y.M)(t=>{this.databases=(t.databases||[]).map(i=>({id:"",databaseName:i,connectionString:null,extraProperties:{}})),this.selectFirstDatabase()}))}getConnectionStrings(){return this.service.getConnectionStrings(this.selectedTenant.id).pipe((0,y.M)(t=>{this.form.setValue({useSharedDatabase:!t.default&&!t.databases.some(i=>!!i.connectionString),defaultConnectionString:t.default}),this.databases=t.databases,this.moduleSpecificDatabase=!1,this.databases.find(i=>{i.connectionString&&(this.moduleSpecificDatabase=!0)}),this.selectFirstDatabase()}))}onSharedDatabaseChange(){this.defaultConnectionString.setValue(null),this.defaultConnectionString.updateValueAndValidity()}addDatabaseConnectionString(){if(!this.databaseConnectionString)return;const t=this.databases.findIndex(i=>i.databaseName===this.selectedDatabase.databaseName);this.databases[t].connectionString=this.databaseConnectionString,this.databaseConnectionString=null,this.selectFirstDatabase()}removeDbConnectionString(t){this.databases[t].connectionString=null}getInput(){return this.useSharedDatabase.value?{extraProperties:void 0,id:"",default:null,databases:[]}:{extraProperties:void 0,id:"",default:this.defaultConnectionString.value,databases:this.databases.filter(t=>t.connectionString)}}checkConnectionString(t){if(!t&&!this.defaultConnectionString.value)return this.toasterService.error("Saas::InvalidConnectionString");this.service.checkConnectionString(t||this.defaultConnectionString.value).subscribe(i=>{if(i)return this.toasterService.success("Saas::ValidConnectionString");this.toasterService.error("Saas::InvalidConnectionString")})}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["abp-connection-strings"]],inputs:{selectedTenant:"selectedTenant"},outputs:{formSubmit:"formSubmit"},decls:3,vars:1,consts:[["popContent",""],["popover","ngbPopover"],[1,"mt-2"],[1,"text-center"],[3,"formGroup"],[1,"mb-3"],[1,"form-check","mb-2"],["id","useSharedDatabase","type","checkbox","formControlName","useSharedDatabase","autofocus","",1,"form-check-input",3,"ngModelChange"],["for","useSharedDatabase",1,"form-check-label"],[1,"row"],[1,"col-md-8"],["for","defaultConnectionString",1,"form-label"],["type","text","id","defaultConnectionString","formControlName","defaultConnectionString",1,"form-control"],[1,"pt-3","col-md-2"],["type","button",1,"btn","btn-primary",3,"click"],[1,"mb-3","form-check"],["id","moduleSpecificDatabase","type","checkbox",1,"form-check-input",3,"ngModelChange","ngModel"],["for","moduleSpecificDatabase",1,"form-check-label"],[1,"row","align-items-end"],[1,"mb-3","col-lg-3"],["for","database-name",1,"form-label"],["id","database-name","name","database-name",1,"form-select","form-control",3,"ngModelChange","ngModel"],[1,"mb-3","col-lg-6"],["for","connection-string",1,"form-label"],["type","text","id","connection-string","name","connection-string",1,"form-control",3,"ngModelChange","keyup.enter","ngModel"],["type","button",1,"btn","btn-primary","me-1",3,"click"],[1,"form-row"],[1,"table"],[3,"ngValue"],["placement","left",1,"btn","btn-sm","btn-danger",3,"ngbPopover"],["aria-hidden","true",1,"fas","fa-trash"],[1,"text-end"],[1,"btn","btn-sm","btn-light","me-1",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],["aria-hidden","true",1,"fas","fa-spinner","fa-spin","fa-lg"]],template:function(i,a){1&i&&(e.j41(0,"div",2),e.DNE(1,lt,9,6)(2,ct,2,0,"div",3),e.k0s()),2&i&&(e.R7$(),e.vxM(a.loading?2:1))},dependencies:[_.a5,_.lt,r.qT,r.xH,r.y7,r.me,r.Zm,r.wz,r.BC,r.cb,r.vS,r.j4,r.JD,l.B7c,b.ZM,l.aM3],encapsulation:2})}}return n})(),X=(()=>{class n{constructor(){this.fb=(0,e.WQX)(r.ok),this.tenantService=(0,e.WQX)(R),this.toaster=(0,e.WQX)(d.W9),this.modalVisible=!1,this.tenantId="",this.modalVisibleChange=new e.bkB,this.fieldTextType=!1}buildForm(){this.form=this.fb.group({adminName:["admin",[r.k0.required]],password:["",[r.k0.required]]})}save(t){if(this.form.invalid)return;const{adminName:i,password:a}=this.form.value;this.modalBusy=!0,this.tenantService.setPassword(this.tenantId,{username:i,password:a}).subscribe(()=>{this.toaster.success("AbpIdentity::PasswordChangedMessage"),t.resetForm(),this.modalVisibleChange.emit()}).add(()=>this.modalBusy=!1)}onModalVisibleChange(t){t||this.modalVisibleChange.emit()}ngOnChanges({modalVisible:t}){t&&t.currentValue&&this.buildForm()}generatePassword(){this.form.controls.password.setValue((0,l.bkx)())}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["abp-set-tenant-password-modal"]],inputs:{modalVisible:"modalVisible",tenantName:"tenantName",tenantId:"tenantId"},outputs:{modalVisibleChange:"modalVisibleChange"},features:[e.OA$],decls:7,vars:4,consts:[["abpHeader",""],["abpBody",""],["abpFooter",""],["ngForm","ngForm"],[3,"visibleChange","visible","busy","options"],["id","setPasswordForm","validateOnSubmit","",3,"formGroup","markAsDirtyWhenSubmit"],["id","setPasswordForm","validateOnSubmit","",3,"ngSubmit","formGroup","markAsDirtyWhenSubmit"],[1,"mb-3"],["for","adminName",1,"form-label"],["type","text","id","adminName","name","adminName","formControlName","adminName",1,"form-control",3,"ngbTooltip"],["for","password",1,"form-label"],["validationStyle","","validationTarget","",1,"input-group"],["id","password","name","password","formControlName","password","autofocus","",1,"form-control","flex-fill",3,"type"],["type","button",1,"btn","btn-secondary",3,"click"],["id","generate-random-password-button","type","button",1,"btn","btn-primary","rounded-end",3,"click","ngbTooltip"],["aria-hidden","false",1,"fa","fa-refresh"],["type","button","abpClose","",1,"btn","btn-outline-primary"],["iconClass","fa fa-check","buttonType","submit","formName","setPasswordForm"]],template:function(i,a){if(1&i){const s=e.RV6();e.j41(0,"abp-modal",4),e.mxI("visibleChange",function(p){return e.eBV(s),e.DH7(a.modalVisible,p)||(a.modalVisible=p),e.Njj(p)}),e.bIt("visibleChange",function(p){return e.eBV(s),e.Njj(a.onModalVisibleChange(p))}),e.DNE(1,pt,3,4,"ng-template",null,0,e.C5r)(3,ut,1,1,"ng-template",null,1,e.C5r)(5,_t,6,6,"ng-template",null,2,e.C5r),e.k0s()}2&i&&(e.R50("visible",a.modalVisible),e.Y8G("busy",a.modalBusy)("options",e.lJ4(3,dt)))},dependencies:[_.a5,_.WE,_.Ss,_.lt,r.qT,r.me,r.BC,r.cb,r.j4,r.JD,l.B7c,l.S02,d.Qp,d.zf,d.b6,b.md,l.aM3],encapsulation:2})}}return n})();const be=c.SY.createMany([{text:"Saas::Edit",action:n=>{n.getInjected(S).onEditEdition(n.record.id)},permission:"Saas.Editions.Update"},{text:"Saas::Features",action:n=>{n.getInjected(S).openFeaturesModal(n.record.id)},permission:"Saas.Editions.ManageFeatures"},{text:"Saas::ChangeHistory",action:n=>{n.getInjected(g.BQ)(n.record.id,"Volo.Saas.Editions.Edition")},permission:"AuditLogging.ViewChangeHistory:Volo.Saas.Edition",visible:n=>!!n.getInjected(g.BQ,null)},{text:"Saas::Delete",action:n=>{n.getInjected(S).delete(n.record)},permission:"Saas.Editions.Delete"},{text:"Saas::MoveAllTenants",action:n=>{n.getInjected(S).moveAllTenants(n.record)},permission:"Saas.Tenants.Update"}]),he=c.Fh.createMany([{type:"string",name:"displayName",displayName:"Saas::EditionName",sortable:!0},{type:"number",name:"tenantCount",displayName:"Saas::TenantCount"}]),z=c.UW.createMany([{type:"string",name:"displayName",displayName:"Saas::EditionName",validators:()=>[r.k0.required,r.k0.maxLength(256)]},{type:"enum",name:"planId",displayName:"Saas::PlanId",visible:n=>!!n.getInjected(S).plans$.value.length,options:n=>n.getInjected(S).plans$.pipe((0,I.T)(t=>[{key:"-",value:null}].concat(t.map(i=>({key:i.name,value:i.id})))))}]),ge=c.KR.createMany([{text:"Saas::NewEdition",action:n=>{n.getInjected(S).onAddEdition()},permission:"Saas.Editions.Create",icon:"fa fa-plus"}]);let Y=(()=>{class n{constructor(){this.store=new l.JG$({tenantId:null,isVisible:void 0}),this.isVisible$=this.store.sliceState(t=>t.isVisible)}get tenantId(){return this.store.state.tenantId}setTenantId(t){this.store.patch({tenantId:t})}setValue(t){this.store.patch({isVisible:t})}hide(){this.setValue(!1),this.setTenantId(null)}show(t){this.setValue(!0),this.setTenantId(t)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const fe=c.SY.createMany([{text:"Saas::Edit",action:n=>{n.getInjected(f).onEditTenant(n.record.id)},permission:"Saas.Tenants.Update"},{text:"Saas::ConnectionStrings",action:n=>{n.getInjected(f).onEditConnectionString(n.record)},permission:"Saas.Tenants.ManageConnectionStrings"},{text:"Saas::ApplyDatabaseMigrations",action:n=>{n.getInjected(f).applyDatabaseMigrations(n.record.id)},permission:"Saas.Tenants.ManageConnectionStrings",visible:n=>n.record.hasDefaultConnectionString},{text:"Saas::Features",action:n=>{n.getInjected(f).openFeaturesModal(n.record.id)},permission:"Saas.Tenants.ManageFeatures"},{text:"Saas::ChangeHistory",action:n=>{n.getInjected(g.BQ)(n.record.id,"Volo.Saas.Tenants.Tenant")},permission:"AuditLogging.ViewChangeHistory:Volo.Saas.Tenant",visible:n=>!!n.getInjected(g.BQ,null)},{text:"Saas::LoginWithThisTenant",action:n=>{n.getInjected(Y).show(n.record.id)},permission:"Saas.Tenants.Impersonation",visible:n=>{const o=n.getInjected(l.d14),t=n.getInjected(l.vf1),i=o.getDeep("currentUser.impersonatorUserId"),{activationState:a,activationEndDate:s}=n.record||{},m=t.getImpersonation();if(!m||!m.tenantImpersonation)return!1;const p=a==h.Active,T=a==h.ActiveWithLimitedTime,v=new Date(s)>new Date;return(p||T&&v)&&null===i}},{text:"Saas::SetPassword",action:n=>{n.getInjected(f).openSetTenantPasswordModal(n.record.id,n.record.name)},permission:"Saas.Tenants.SetPassword"},{text:"Saas::Delete",action:n=>{n.getInjected(f).delete(n.record.id,n.record.name)},permission:"Saas.Tenants.Delete"}]),Te=c.Fh.createMany([{type:"string",name:"name",displayName:"Saas::TenantName",sortable:!0,columnWidth:300},{type:"string",name:"editionName",displayName:"Saas::EditionName",columnWidth:300},{type:"datetime",name:"editionEndDateUtc",displayName:"Saas::EditionEndDateUtc",columnWidth:300,tooltip:{text:"Saas::EditionEndDateToolTip"}},{type:"string",name:"activationState",displayName:"Saas::ActivationState",columnWidth:300,valueResolver:n=>{const o=n.getInjected(l.PiF),t=n.getInjected(l.d14),i=n.getInjected(e.xe9),{shortDatePattern:a,shortTimePattern:s}=t.getDeep("localization.currentCulture.dateTimeFormat");let m="";switch(n.record.activationState){case h.Active:return m=o.instant("Saas::Enum:TenantActivationState.Active"),(0,E.of)(m);case h.ActiveWithLimitedTime:return m=`${o.instant("Saas::Enum:TenantActivationState.ActiveWithLimitedTime")} (${(0,C.Yq)(n.record.activationEndDate,`${a} ${s.replace("tt","a")}`,i)})`,(0,E.of)(m);case h.Passive:return m=o.instant("Saas::Enum:TenantActivationState.Passive"),(0,E.of)(m)}}}]),k=c.UW.createMany([{type:"string",name:"name",id:"name",displayName:"Saas::TenantName",validators:()=>[r.k0.required,r.k0.maxLength(256)]},{type:"string",name:"editionId",displayName:"Saas::Edition",id:"edition",disabled:n=>{const o=n.record.editionEndDateUtc;return o&&new Date(o).getTime()<(new Date).getTime()},options:n=>{const o=n.getInjected(f).editions,i={value:null,key:n.getInjected(l.PiF).instant("AbpUi::NotAssigned")};return(0,E.of)([i,...o.map(a=>({key:a.displayName,value:a.id}))])}},{type:"email",name:"adminEmailAddress",displayName:"Saas::DisplayName:AdminEmailAddress",id:"admin-email-address",validators:()=>[r.k0.required,r.k0.maxLength(256),r.k0.email],formText:"Saas::DisplayName:AdminEmailAddressFormText"},{type:"passwordinputgroup",name:"adminPassword",displayName:"Saas::DisplayName:AdminPassword",id:"admin-password",autocomplete:"new-password",validators:()=>[r.k0.required]},{type:"string",name:"activationState",displayName:"Saas::DisplayName:ActivationState",id:"activation-state",validators:()=>[r.k0.required],defaultValue:h.Active,options:n=>{const o=n.getInjected(l.PiF);return(0,E.of)([{key:o.instant("Saas::Enum:TenantActivationState.Active"),value:h.Active},{key:o.instant("Saas::Enum:TenantActivationState.ActiveWithLimitedTime"),value:h.ActiveWithLimitedTime},{key:o.instant("Saas::Enum:TenantActivationState.Passive"),value:h.Passive}])}},{type:"datetime",name:"activationEndDate",displayName:"Saas::DisplayName:ActivationEndDate",id:"activation-end-date",visible:n=>{const{tenantForm:o}=n.getInjected(f);return o.get("activationState").value===h.ActiveWithLimitedTime}}]),Se=[...k.slice(0,2),...k.slice(-2)],ve=c.KR.createMany([{text:"Saas::NewTenant",action:n=>{n.getInjected(f).onAddTenant()},permission:"Saas.Tenants.Create",icon:"fa fa-plus"}]),W={"Saas.EditionsComponent":be,"Saas.TenantsComponent":fe},Q={"Saas.EditionsComponent":ge,"Saas.TenantsComponent":ve},J={"Saas.EditionsComponent":he,"Saas.TenantsComponent":Te},H={"Saas.EditionsComponent":z,"Saas.TenantsComponent":k},K={"Saas.EditionsComponent":z,"Saas.TenantsComponent":Se},x=new e.nKC("SAAS_ENTITY_ACTION_CONTRIBUTORS"),O=new e.nKC("SAAS_TOOLBAR_ACTION_CONTRIBUTORS"),V=new e.nKC("SAAS_ENTITY_PROP_CONTRIBUTORS"),G=new e.nKC("SAAS_CREATE_FORM_PROP_CONTRIBUTORS"),L=new e.nKC("SAAS_EDIT_FORM_PROP_CONTRIBUTORS");let q=(()=>{class n{get isVisible$(){return this.service.isVisible$}constructor(){this.service=(0,e.WQX)(Y),this.fb=(0,e.WQX)(r.ok),this.impersonationService=(0,e.WQX)(Ae.Or),this.subscription=(0,e.WQX)(l.nCQ),this.confirmation=(0,e.WQX)(d.td),this.defaultTenantUserName="admin",this.buildForm()}success(){this.reset()}reset(){this.service.hide(),this.form.reset({tenantUserName:this.defaultTenantUserName})}buildForm(){this.form=this.fb.group({tenantUserName:[this.defaultTenantUserName,[r.k0.required]]})}error(t){this.subscription.addOne(this.confirmation.error(t.error.error_description,t.error.error,{hideCancelBtn:!0,yesText:"AbpUi::Ok"})),console.error(t.error)}visibleChange(t){void 0===t||t||(this.service.setValue(t),this.reset())}save(){if(this.form.invalid)return;const a=this.impersonationService.impersonateTenant(this.service.tenantId,this.form.value.tenantUserName);this.subscription.addOne(a,()=>{this.success()},s=>{this.error(s)})}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["abp-impersonate-tenant-modal"]],features:[e.Jv_([l.nCQ])],decls:8,vars:3,consts:[["abpHeader",""],["abpBody",""],["abpFooter",""],[3,"visibleChange","visible"],["id","impersonateTenantForm",3,"formGroup"],["id","impersonateTenantForm",3,"ngSubmit","formGroup"],[1,"mb-3"],["for","tenantUserName",1,"form-label"],["type","text","name","tenantUserName","id","tenantUserName","formControlName","tenantUserName",1,"form-control"],["type","button",1,"btn","btn-outline-primary",3,"click"],["form","impersonateTenantForm","type","submit",1,"btn","btn-primary"]],template:function(i,a){if(1&i){const s=e.RV6();e.j41(0,"abp-modal",3),e.nI1(1,"async"),e.bIt("visibleChange",function(p){return e.eBV(s),e.Njj(a.visibleChange(p))}),e.DNE(2,bt,3,3,"ng-template",null,0,e.C5r)(4,gt,1,1,"ng-template",null,1,e.C5r)(6,ft,6,6,"ng-template",null,2,e.C5r),e.k0s()}2&i&&e.Y8G("visible",e.bMT(1,1,a.isVisible$))},dependencies:[_.a5,_.lt,r.qT,r.me,r.BC,r.cb,r.j4,r.JD,l.S02,d.zf,C.Jj,l.aM3],encapsulation:2})}}return n})(),f=(()=>{class n{constructor(){this.list=(0,e.WQX)(l.aGM),this.service=(0,e.WQX)(R),this.confirmationService=(0,e.WQX)(d.td),this.fb=(0,e.WQX)(r.ze),this.injector=(0,e.WQX)(e.zZn),this.toasterService=(0,e.WQX)(d.W9),this.editionService=(0,e.WQX)(N),this.tenantFormValidators=(0,e.WQX)(B),this.data={items:[],totalCount:0},this.selectedModalContent={},this.visibleFeatures=!1,this.isVisibleSetTenantPasswordModal=!1,this.selectedTenantId="",this.selectedTenantNameForSetTenantPasswordModal="",this.modalBusy=!1,this.emptyOption={label:"-",value:null},this.connectionStringsReplacementKey="Saas.ConnectionStringsComponent",this.setTenantPasswordReplacementKey="Saas.SetTenantPasswordComponent",this.activationStateOptions=Me,this.setTenantReplaceableTemplateOptions=null,this.onVisibleFeaturesChange=t=>{this.visibleFeatures=t},this.closeSetTenantPasswordModal=()=>{this.isVisibleSetTenantPasswordModal=!1,this.selectedTenantNameForSetTenantPasswordModal="",this.selectedTenantId="",this.setTenantReplaceableTemplateOptions=null}}get hasSelectedTenant(){return!!this.selected.id}get isDisabledSaveButton(){if(!this.selectedModalContent)return!1;const{type:t}=this.selectedModalContent,i=this.connectionStringsRef?.form.invalid;return!("saveConnStr"!==t||!i)||"saveTenant"===t&&this.tenantForm&&this.tenantForm.invalid}ngOnInit(){this.buildForm(),this.hookToQuery()}clearFilters(){this.formFilters.reset({times:{}})}hookToQuery(){this.list.hookToQuery(t=>{const i={...this.formFilters.value,...this.formFilters.value.times};return this.service.getList({...t,...i})}).subscribe(t=>this.data=t)}createTenantForm(){return this.editionService.getList({maxResultCount:1e3}).pipe((0,y.M)(t=>{this.editions=t.items;const i=new c.a9(this.injector,this.selected);this.tenantForm=(0,c.uB)(i),this.tenantFormValidators&&this.tenantForm.addAsyncValidators(this.tenantFormValidators),i.record?.editionId||this.tenantForm.controls.editionId.patchValue(null)}))}openModal(t,i,a){this.selectedModalContent={title:t,template:i,type:a},this.isModalVisible=!0}onEditConnectionString(t){this.selected=t,this.openModal("Saas::ConnectionStrings",this.connectionStringModalTemplate,"saveConnStr")}onAddTenant(){this.selected={},this.createTenantForm().subscribe(()=>this.openModal("Saas::NewTenant",this.tenantModalTemplate,"saveTenant"))}onEditTenant(t){this.service.get(t).subscribe(i=>{this.selected=i,this.createTenantForm().subscribe(()=>this.openModal("Saas::Edit",this.tenantModalTemplate,"saveTenant"))})}save(){const{type:t}=this.selectedModalContent||{};"saveTenant"!==t?"saveConnStr"===t&&this.saveConnectionString():this.saveTenant()}saveConnectionString(){this.modalBusy||this.connectionStringsRef.form.invalid||this.service.updateConnectionStrings(this.selected.id,this.connectionStringsRef.getInput()).pipe((0,F.j)(()=>this.modalBusy=!1)).subscribe(()=>{this.isModalVisible=!1,this.list.get(),this.toasterService.success("AbpUi::SavedSuccessfully")})}saveTenant(){if(!this.tenantForm.valid||this.modalBusy)return;this.modalBusy=!0;const t={...this.tenantForm.value,...!this.selected.id&&{connectionStrings:this.connectionStringsRef.getInput()}},{id:i}=this.selected;(i?this.service.update(i,{...this.selected,...t}):this.service.create(t)).pipe((0,F.j)(()=>this.modalBusy=!1)).subscribe(()=>{this.list.get(),this.isModalVisible=!1,this.toasterService.success("AbpUi::SavedSuccessfully")})}delete(t,i){this.confirmationService.warn("Saas::TenantDeletionConfirmationMessage","AbpUi::AreYouSure",{messageLocalizationParams:[i]}).subscribe(a=>{a===d.m.Status.confirm&&(this.service.delete(t).subscribe(()=>this.list.get()),this.toasterService.success("AbpUi::DeletedSuccessfully","",{life:6e3}))})}onSharedDatabaseChange(t){t||setTimeout(()=>{const i=document.getElementById("defaultConnectionString");i&&i.focus()},0)}openFeaturesModal(t){this.providerKey=t,setTimeout(()=>{this.visibleFeatures=!0},0)}openSetTenantPasswordModal(t,i){this.isVisibleSetTenantPasswordModal=!0,this.selectedTenantNameForSetTenantPasswordModal=i,this.selectedTenantId=t,this.setTenantReplaceableTemplateOptions={outputs:{modalVisibleChange:this.closeSetTenantPasswordModal},inputs:{modalVisible:{value:this.isVisibleSetTenantPasswordModal},tenantId:{value:this.selectedTenantId},tenantName:{value:this.selectedTenantNameForSetTenantPasswordModal}},componentKey:this.setTenantPasswordReplacementKey}}applyDatabaseMigrations(t){this.service.applyDatabaseMigrations(t).subscribe(()=>this.toasterService.info("Saas::DatabaseMigrationQueuedAndWillBeApplied","",{life:6e3}))}buildForm(){this.formFilters=this.fb.group({getEditionNames:[null,[]],editionId:[null,[]],times:[{}],activationState:[null,[]]})}getData(){this.formFilters.invalid&&this.formFilters.touched||this.list.get()}getEditionLookup(){return()=>this.service.getEditionLookup().pipe((0,I.T)(t=>({items:t})))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["abp-tenants"]],viewQuery:function(i,a){if(1&i&&(e.GBs(j,5),e.GBs(Tt,5),e.GBs(St,5)),2&i){let s;e.mGM(s=e.lsd())&&(a.connectionStringsRef=s.first),e.mGM(s=e.lsd())&&(a.tenantModalTemplate=s.first),e.mGM(s=e.lsd())&&(a.connectionStringModalTemplate=s.first)}},features:[e.Jv_([l.aGM,{provide:c.JF,useValue:"Saas.TenantsComponent"},{provide:b.dn,useClass:d.MJ}])],decls:60,vars:51,consts:[["filterForm",""],["abpHeader",""],["abpBody",""],["abpFooter",""],["tenantModalTemplate",""],["connectionStringModalTemplate",""],["createTenantTmp",""],["tenantFormTmp",""],["connectionStrings",""],["nav","ngbNav"],[3,"title","toolbar"],["id","wrapper"],["localizationSourceName","Saas",3,"list"],[3,"formGroup"],[1,"row"],[1,"col-12","col-sm-3"],[1,"mb-3"],["for","editionIdFilter",1,"form-label"],["cid","editionIdFilter","formControlName","editionId",3,"emptyOption","getFn"],[1,"form-label",3,"ngbTooltip"],["aria-hidden","true",1,"fa","fa-info-circle"],["formControlName","times","startDateProp","expirationDateMin","endDateProp","expirationDateMax"],["for","activationState",1,"form-label"],["id","activationState","formControlName","activationState",1,"form-select","form-control"],[3,"ngValue"],[1,"col-12","col-sm-auto","align-self-end","mb-3"],[1,"col-6","col-sm-auto","d-grid"],["type","button",1,"btn","btn-outline-primary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"card"],[3,"data","recordsTotal","list"],[3,"visibleChange","visible","busy","options"],[3,"modalVisible","tenantId","tenantName"],["providerName","T",3,"visible","providerKey","visibleChange",4,"abpReplaceableTemplate"],[4,"ngTemplateOutlet"],["abpClose","","type","button",1,"btn","btn-outline-primary"],["iconClass","fa fa-check","buttonType","submit","formName","editOrCreateForm"],["iconClass","fa fa-check",3,"disabled"],["iconClass","fa fa-check",3,"click","disabled"],[3,"modalVisible","tenantId","tenantName","modalVisibleChange",4,"abpReplaceableTemplate"],[3,"modalVisibleChange","modalVisible","tenantId","tenantName"],["ngbNav","",1,"nav-tabs",3,"destroyOnHide"],["ngbNavItem",""],["ngbNavLink",""],["ngbNavContent",""],[3,"ngbNavOutlet"],["id","editOrCreateForm","validateOnSubmit","",1,"py-2",3,"formGroup"],["id","editOrCreateForm","validateOnSubmit","",1,"py-2",3,"ngSubmit","formGroup"],[3,"selectedRecord"],[3,"formSubmit",4,"abpReplaceableTemplate"],[3,"formSubmit"],[3,"selectedTenant","formSubmit",4,"abpReplaceableTemplate"],[3,"formSubmit","selectedTenant"],["providerName","T",3,"visibleChange","visible","providerKey"]],template:function(i,a){if(1&i){const s=e.RV6();e.j41(0,"abp-page",10),e.nI1(1,"abpLocalization"),e.j41(2,"div",11)(3,"abp-advanced-entity-filters",12)(4,"abp-advanced-entity-filters-form")(5,"form",13,0)(7,"div",14)(8,"div",15)(9,"div",16)(10,"label",17),e.EFF(11),e.nI1(12,"abpLocalization"),e.k0s(),e.nrm(13,"abp-lookup-select",18),e.k0s()(),e.j41(14,"div",15)(15,"div",16)(16,"label",19),e.nI1(17,"abpLocalization"),e.EFF(18),e.nI1(19,"abpLocalization"),e.nrm(20,"i",20),e.k0s(),e.nrm(21,"abp-date-range-picker",21),e.k0s()(),e.j41(22,"div",15)(23,"div",16)(24,"label",22),e.EFF(25),e.nI1(26,"abpLocalization"),e.k0s(),e.j41(27,"select",23)(28,"option",24),e.EFF(29,"-"),e.k0s(),e.Z7z(30,Nt,3,4,"option",24,e.Vm6),e.k0s()()(),e.j41(32,"div",25)(33,"div",14)(34,"div",26)(35,"button",27),e.bIt("click",function(){return e.eBV(s),e.Njj(a.clearFilters())}),e.j41(36,"span"),e.EFF(37),e.nI1(38,"abpLocalization"),e.k0s()()(),e.j41(39,"div",26)(40,"button",28),e.bIt("click",function(){return e.eBV(s),e.Njj(a.getData())}),e.j41(41,"span"),e.EFF(42),e.nI1(43,"abpLocalization"),e.k0s()()()()()()()()(),e.j41(44,"div",29),e.nrm(45,"abp-extensible-table",30),e.k0s()()(),e.j41(46,"abp-modal",31),e.mxI("visibleChange",function(p){return e.eBV(s),e.DH7(a.isModalVisible,p)||(a.isModalVisible=p),e.Njj(p)}),e.DNE(47,It,3,3,"ng-template",null,1,e.C5r)(49,Mt,1,1,"ng-template",null,2,e.C5r)(51,jt,5,4,"ng-template",null,3,e.C5r),e.k0s(),e.DNE(53,xt,1,1,"abp-set-tenant-password-modal",32)(54,zt,7,1,"ng-template",null,4,e.C5r)(56,Wt,1,11,"ng-template",null,5,e.C5r)(58,Qt,1,2,"abp-feature-management",33),e.nrm(59,"abp-impersonate-tenant-modal")}2&i&&(e.Y8G("title",e.bMT(1,22,"Saas::Tenants"))("toolbar",a.data.items),e.R7$(3),e.Y8G("list",a.list),e.R7$(2),e.Y8G("formGroup",a.formFilters),e.R7$(6),e.SpI(" ",e.bMT(12,24,"Saas::Edition")," "),e.R7$(2),e.Y8G("emptyOption",a.emptyOption)("getFn",a.getEditionLookup()),e.R7$(3),e.Y8G("ngbTooltip",e.bMT(17,26,"Saas::EditionEndDateToolTip")),e.R7$(2),e.SpI(" ",e.bMT(19,28,"Saas::DisplayName:ExpirationDate")," "),e.R7$(7),e.JRh(e.bMT(26,30,"Saas::DisplayName:ActivationState")),e.R7$(3),e.Y8G("ngValue",null),e.R7$(2),e.Dyx(a.activationStateOptions),e.R7$(7),e.JRh(e.bMT(38,32,"AbpUi::Clear")),e.R7$(3),e.Y8G("disabled",a.formFilters.invalid),e.R7$(2),e.JRh(e.bMT(43,34,"AbpUi::Refresh")),e.R7$(3),e.Y8G("data",a.data.items)("recordsTotal",a.data.totalCount)("list",a.list),e.R7$(),e.R50("visible",a.isModalVisible),e.Y8G("busy",a.modalBusy)("options",e.lJ4(36,vt)),e.R7$(7),e.vxM(a.setTenantReplaceableTemplateOptions?53:-1),e.R7$(5),e.Y8G("abpReplaceableTemplate",e.l_i(48,re,e.sMw(42,oe,e.lJ4(37,Ct),e.eq3(38,U,a.providerKey),e.eq3(40,ae,a.visibleFeatures)),e.eq3(46,se,a.onVisibleFeaturesChange))))},dependencies:[_.a5,_.lt,C.T3,r.qT,r.xH,r.y7,r.wz,r.BC,r.cb,r.j4,r.JD,l.S02,l.y98,g.Q0,g.fI,c.X3,c.XY,g.Is,g.KQ,d.Qp,d.zf,d.b6,D.NO,M.H1,b.Um,b.X9,b.sy,b.Gx,b.Ri,b.WA,b.m_,b.md,j,X,q,l.aM3],encapsulation:2})}}return n})(),Ce=(()=>{class n{constructor(t,i){this.permissionService=t,this.service=i,this.data={},this.initialized=new te.t(this),this.width=273,this.height=136,this.chartData={},this.draw=()=>{this.permissionService.getGrantedPolicy("Saas.Editions")&&this.service.getUsageStatistics().subscribe(a=>{this.data=a.data,this.setChartData()})}}setChartData(){if(!this.data||"{}"===JSON.stringify(this.data))return void(this.chartData={});const t=Object.keys(this.data);setTimeout(()=>{this.chartData={labels:t,datasets:[{data:t.map(i=>this.data[i]),backgroundColor:(0,A.tj)(Object.keys(this.data).length)}]},this.chart.refresh()},0)}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(l.n1S),e.rXU(N))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["abp-editions-usage-widget"]],viewQuery:function(i,a){if(1&i&&e.GBs(A.Qe,5),2&i){let s;e.mGM(s=e.lsd())&&(a.chart=s.first)}},inputs:{width:"width",height:"height"},outputs:{initialized:"initialized"},features:[e.Jv_([l.nCQ])],decls:1,vars:1,consts:[["chart",""],["class","abp-widget-wrapper",4,"abpPermission"],[1,"abp-widget-wrapper"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[1,"row"],["type","pie",1,"w-100",3,"data","width","height"]],template:function(i,a){1&i&&e.DNE(0,Jt,10,6,"div",1),2&i&&e.Y8G("abpPermission","Saas.Editions")},dependencies:[l.Dud,A.Qe,l.aM3],encapsulation:2})}}return n})(),Ee=(()=>{class n{constructor(t,i){this.service=t,this.permissionService=i,this.minHeight=136,this.trackByFn=(a,s)=>s.id,this.draw=()=>{this.permissionService.getGrantedPolicy("Saas.Tenants")&&this.service.getList({getEditionNames:!0,maxResultCount:6,skipCount:0,sorting:"CreationTime desc"}).subscribe(a=>this.data=a.items)}}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(R),e.rXU(l.n1S))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["abp-latest-tenants-widget"]],inputs:{minHeight:"minHeight"},decls:1,vars:1,consts:[["class","abp-widget-wrapper","data-widget-name","SaasLatestTenantsWidget","data-refresh-url","SaasWidgets/LatestTenants",4,"abpPermission"],["data-widget-name","SaasLatestTenantsWidget","data-refresh-url","SaasWidgets/LatestTenants",1,"abp-widget-wrapper"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[1,"table","table-hover","table-sm"]],template:function(i,a){1&i&&e.DNE(0,Kt,22,11,"div",0),2&i&&e.Y8G("abpPermission","Saas.Tenants")},dependencies:[l.Dud,l.aM3],encapsulation:2})}}return n})(),qt=(()=>{class n{constructor(t){this.injector=t}canActivate(){const t=this.injector.get(c.yJ),i=this.injector.get(x,null)||{},a=this.injector.get(O,null)||{},s=this.injector.get(V,null)||{},m=this.injector.get(G,null)||{},p=this.injector.get(L,null)||{},T=this.injector.get(l.d14);return(0,c.Nl)(T,"Saas").pipe((0,I.T)(v=>({"Saas.EditionsComponent":v.Edition,"Saas.TenantsComponent":v.Tenant})),(0,c.p2)(T,"Saas"),(0,y.M)(v=>{(0,c.xB)(t.entityActions,W,i),(0,c.xB)(t.toolbarActions,Q,a),(0,c.ah)(t.entityProps,J,v.prop,s),(0,c.ah)(t.createFormProps,H,v.createForm,m),(0,c.ah)(t.editFormProps,K,v.editForm,p)}),(0,I.T)(()=>!0))}static{this.\u0275fac=function(i){return new(i||n)(e.KVO(e.zZn))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac})}}return n})();const Fe=()=>{const n=(0,e.WQX)(e.zZn),o=n.get(c.yJ),t=n.get(x,null)||{},i=n.get(O,null)||{},a=n.get(V,null)||{},s=n.get(G,null)||{},m=n.get(L,null)||{},p=n.get(l.d14);return(0,c.Nl)(p,"Saas").pipe((0,I.T)(T=>({"Saas.EditionsComponent":T.Edition,"Saas.TenantsComponent":T.Tenant})),(0,c.p2)(p,"Saas"),(0,y.M)(T=>{(0,c.xB)(o.entityActions,W,t),(0,c.xB)(o.toolbarActions,Q,i),(0,c.ah)(o.entityProps,J,T.prop,a),(0,c.ah)(o.createFormProps,H,T.createForm,s),(0,c.ah)(o.editFormProps,K,T.editForm,m)}))},Zt=[{path:"",redirectTo:"tenants",pathMatch:"full"},{path:"",component:l.Cs_,canActivate:[l.W_R,l.RH_],resolve:[Fe],children:[{path:"tenants",component:l.yFO,data:{requiredPolicy:"Saas.Tenants",replaceableComponent:{key:"Saas.TenantsComponent",defaultComponent:f}},title:"Saas::Tenants"},{path:"editions",component:l.yFO,data:{requiredPolicy:"Saas.Editions",replaceableComponent:{key:"Saas.EditionsComponent",defaultComponent:S}},title:"Saas::Editions"}]}];let en=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[ie.iI.forChild(Zt),ie.iI]})}}return n})(),tn=(()=>{class n{static forChild(t={}){return{ngModule:n,providers:[ue,{provide:x,useValue:t.entityActionContributors},{provide:O,useValue:t.toolbarActionContributors},{provide:V,useValue:t.entityPropContributors},{provide:G,useValue:t.createFormPropContributors},{provide:L,useValue:t.editFormPropContributors}]}}static forLazy(t={}){return new l.l37(n.forChild(t))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[en,_.fs,l.Ui,g.pY,d.Ts,b.zH,D.sQ,M.wq,A.Fr,b.Pv,b.zr,g.Fl,b.IQ,b.n8,S,c.U9]})}}return n})();const nn=/^\d{4}-(0?[1-9]|1[012])-(0?[1-9]|[12][0-9]|3[01])*$/}}]);